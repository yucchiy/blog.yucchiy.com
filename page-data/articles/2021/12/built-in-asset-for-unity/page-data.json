{"componentChunkName":"component---src-templates-post-tsx","path":"/articles/2021/12/built-in-asset-for-unity/","result":{"data":{"markdownRemark":{"html":"<p>この記事は「<a href=\"https://qiita.com/advent-calendar/2021/applibot\">Applibot Advent Calendar 2021</a>」の20日目の記事になります。</p>\n<p>Unityではアプリ内にアセットを組み込む方法がいくつか存在しますが、それぞれの方法で利用方法や実装上の注意点があります。</p>\n<p>アプリ内にアセットを組み込む方法には大きく分けて下記があります。</p>\n<ol>\n<li><code>Assets/Resources</code> というフォルダを作成してその中にアセットを格納する</li>\n<li><code>Assets/StreamingAssets</code> というフォルダを作成してアセットを格納する</li>\n<li>Addressablesを利用してローカルアセットを読み込む</li>\n</ol>\n<p>これらの手法について、それぞれ紹介していきたいと思います。</p>\n<h2 id=\"assetsresources内にアセットを組み込む\" style=\"position:relative;\"><a href=\"#assetsresources%E5%86%85%E3%81%AB%E3%82%A2%E3%82%BB%E3%83%83%E3%83%88%E3%82%92%E7%B5%84%E3%81%BF%E8%BE%BC%E3%82%80\" aria-label=\"assetsresources内にアセットを組み込む permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Assets/Resources内にアセットを組み込む</h2>\n<p><a href=\"https://docs.unity3d.com/2020.3/Documentation/ScriptReference/Resources.html\">Unity - Scripting API: Resources</a></p>\n<p>Assetsフォルダ内にResourcesという名前のフォルダを作成してその中にアセットを配置し、 <a href=\"https://docs.unity3d.com/ScriptReference/Resources.html?_ga=2.2989232.1050104446.1639550329-353882182.1627870586\">ResourcesAPI</a>を用いてロードします。</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">UnityEngine</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Collections</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ExampleClass</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">MonoBehaviour</span></span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> prefab <span class=\"token operator\">=</span> Resources<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">Load</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>GameObject<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Character\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        GameObject<span class=\"token punctuation\">.</span><span class=\"token function\">Instantiate</span><span class=\"token punctuation\">(</span>prefab<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        Resources<span class=\"token punctuation\">.</span><span class=\"token function\">UnloadAsset</span><span class=\"token punctuation\">(</span>prefab<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>配置されたデータはビルド時にアプリ（ipaやapk）内に組み込まれるため、外部からのダウンロードを介さずにアセットをロードできます。</p>\n<h3 id=\"resourcesを利用する際の注意点\" style=\"position:relative;\"><a href=\"#resources%E3%82%92%E5%88%A9%E7%94%A8%E3%81%99%E3%82%8B%E9%9A%9B%E3%81%AE%E6%B3%A8%E6%84%8F%E7%82%B9\" aria-label=\"resourcesを利用する際の注意点 permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Resourcesを利用する際の注意点</h3>\n<p><a href=\"https://learn.unity.com/tutorial/assets-resources-and-assetbundles\">https://learn.unity.com/tutorial/assets-resources-and-assetbundles</a></p>\n<p>ResourcesはUnity公式としては上記の通り「<strong>Don't use it.</strong>」と、利用は推奨されないようです。具体的には下記の理由のようです。</p>\n<ol>\n<li>きめ細かいメモリ管理が行えない</li>\n<li>Resources内のアセットが増えるとアプリの起動時間とビルド時間が長くなる</li>\n<li>特定プラットフォーム下へのカスタムコンテンツの配信、コンテンツのアップグレードがしづらくなる</li>\n</ol>\n<p>特に「2. アプリの起動時間が長くなる」に関しては、Resourcesシステムの初期化が<strong>アプリケーション起動時のスプラッシュ画面</strong>で行われ、アプリ側ではこの<strong>初期化をずらしたり非同期にできません</strong>。つまり、<strong>Resources内にアセットが増えれば増えるほど、アプリの起動が必ず遅くなることを意味する</strong>ので、個人的にはかなり致命的に感じています。</p>\n<p>公式として、Resourcesは下記の用途が適切だと述べています。</p>\n<ol>\n<li>プロトタイピング</li>\n<li>アプリ起動中に常に必要なアセット</li>\n<li>メモリを大量使用しないアセット</li>\n<li>頻繁なパッチ更新の必要がないアセット</li>\n<li>最小限のブートストラップのために必要なアセット（設定など）</li>\n</ol>\n<p>なのでResourcesは、<strong>アプリの設定やゲーム内で常に必須となるようなHUDのアセットやプレハブ</strong>などにとどめて利用するのが良さそうです。</p>\n<h2 id=\"assetsstreamingassets内にアセットを組み込む\" style=\"position:relative;\"><a href=\"#assetsstreamingassets%E5%86%85%E3%81%AB%E3%82%A2%E3%82%BB%E3%83%83%E3%83%88%E3%82%92%E7%B5%84%E3%81%BF%E8%BE%BC%E3%82%80\" aria-label=\"assetsstreamingassets内にアセットを組み込む permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Assets/StreamingAssets内にアセットを組み込む</h2>\n<p><a href=\"https://docs.unity3d.com/2020.3/Documentation/Manual/StreamingAssets.html\">Unity - Manual: Streaming Assets</a></p>\n<p>Unityでアプリ内にアセットを仕込む方法としてResources以外にStreamingAssetsがあります。</p>\n<p>この方法は、Assetsフォルダ下にStreamingAssetsフォルダを作成し、その中にアセットを格納しておくと、ビルド時にアプリ内に（ほぼ）そのままコピーする形でアプリに組み込まれます。</p>\n<p>StreamingAssetsで組み込まれるアセットは、<a href=\"https://docs.unity3d.com/2020.3/Documentation/ScriptReference/Application-streamingAssetsPath.html\">Application.streamingAssetsPath</a> 内に格納されるので、このプロパティを元にパスを構築します。</p>\n<p>ロード方法はプラットフォームごとに若干異なるので注意が必要です。StreamingAssetsは、Resourcesのように専用のAPIは存在せず、通常は構築したパスに対して <code>System.IO.File.ReadAllText</code>や <code>System.IO.FileStream</code> などでファイルを開いてロードします。</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>IO</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">UnityEngine</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TestStreamingAssetTextLoad</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">MonoBehaviour</span></span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// StreamingAssets内のhello.txtの中身を表示します</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> filePath <span class=\"token operator\">=</span> Application<span class=\"token punctuation\">.</span>streamingAssetsPath <span class=\"token operator\">+</span> <span class=\"token string\">\"/hello.txt\"</span><span class=\"token punctuation\">;</span>\n        Debug<span class=\"token punctuation\">.</span><span class=\"token function\">Log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token function\">ReadStreamingAssetsWithIOAsync</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\">Task<span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">ReadStreamingAssetsWithIOAsync</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> path<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">using</span> <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> fileStream <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">FileStream</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> FileMode<span class=\"token punctuation\">.</span>Open<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> resultBytes <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\"><span class=\"token keyword\">byte</span></span><span class=\"token punctuation\">[</span>fileStream<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">await</span> fileStream<span class=\"token punctuation\">.</span><span class=\"token function\">ReadAsync</span><span class=\"token punctuation\">(</span>resultBytes<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> fileStream<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> System<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">.</span>Encoding<span class=\"token punctuation\">.</span>UTF8<span class=\"token punctuation\">.</span><span class=\"token function\">GetString</span><span class=\"token punctuation\">(</span>resultBytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ただし、AndroidではStreamingAssets内のアセットが基本apk内に圧縮して格納されているため、上記のようにそのまま <code>System.IO.FileStream</code> を介してのロードが行なえません。またWebGLビルドのアプリについても直接ロードできません。</p>\n<p>この問題を回避するために、Unityでは WWW または UnityWebRequestにStreamingAssetsのパスを指定することで、指定パスのファイルを読み込めます。</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>IO</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">Cysharp<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">UnityEngine</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TestStreamingAssetTextLoad</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">MonoBehaviour</span></span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// UnityWebRequest経由でStreamingAssetを読み込む</span>\n    <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\">UniTask<span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">ReadStreamingAssetsWithWebRequestAsync</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> path<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> request <span class=\"token operator\">=</span> UnityEngine<span class=\"token punctuation\">.</span>Networking<span class=\"token punctuation\">.</span>UnityWebRequest<span class=\"token punctuation\">.</span><span class=\"token function\">Get</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// UniTaskの機能で非同期に読み込む</span>\n        <span class=\"token keyword\">await</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">SendWebRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> request<span class=\"token punctuation\">.</span>downloadHandler<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> filePath <span class=\"token operator\">=</span> Application<span class=\"token punctuation\">.</span>streamingAssetsPath <span class=\"token operator\">+</span> <span class=\"token string\">\"/hello.txt\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// Androidは読み込み方法が異なるため、UNITY_ANDROIDなどで呼び分けする</span>\n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">if</span> !UNITY_EDITOR &amp;&amp; </span><span class=\"token return-type class-name\">UNITY_ANDROID</span>\n        Debug<span class=\"token punctuation\">.</span><span class=\"token function\">Log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token function\">ReadStreamingAssetsWithWebRequestAsync</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">else</span></span>\n        Debug<span class=\"token punctuation\">.</span><span class=\"token function\">Log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token function\">ReadStreamingAssetsWithIOAsync</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">endif</span></span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\">Task<span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">ReadStreamingAssetsWithIOAsync</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> path<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">using</span> <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> fileStream <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">FileStream</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> FileMode<span class=\"token punctuation\">.</span>Open<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> resultBytes <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\"><span class=\"token keyword\">byte</span></span><span class=\"token punctuation\">[</span>fileStream<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">await</span> fileStream<span class=\"token punctuation\">.</span><span class=\"token function\">ReadAsync</span><span class=\"token punctuation\">(</span>resultBytes<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> fileStream<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> System<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">.</span>Encoding<span class=\"token punctuation\">.</span>UTF8<span class=\"token punctuation\">.</span><span class=\"token function\">GetString</span><span class=\"token punctuation\">(</span>resultBytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>このように、<strong>プラットフォームごとにStreamingAssetsの扱いが異なる可能性がある</strong>点に注意が必要です。</p>\n<p>また、StreamingAssetsではファイルを原則 <code>byte[]</code> または <code>string</code> としてロードすることになります。つまりそのまま利用すると<strong>プレハブやScriptableObjectsなどのアセットをロードして、インスタンス化することができません</strong>。</p>\n<h3 id=\"streamingassetsでプレハブやscriptableobjectなどを読み込む方法\" style=\"position:relative;\"><a href=\"#streamingassets%E3%81%A7%E3%83%97%E3%83%AC%E3%83%8F%E3%83%96%E3%82%84scriptableobject%E3%81%AA%E3%81%A9%E3%82%92%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%82%80%E6%96%B9%E6%B3%95\" aria-label=\"streamingassetsでプレハブやscriptableobjectなどを読み込む方法 permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>StreamingAssetsでプレハブやScriptableObjectなどを読み込む方法</h3>\n<p>StreamingAssetsにアセットを組み込みつつ、プレハブやScriptableObjectsをロードしてインスタンス化するには、StreamingAssets内にアセットバンドルとしてデータを組み込みこんで、<a href=\"https://docs.unity3d.com/2020.3/Documentation/ScriptReference/AssetBundle.html\">AssetBundleAPI</a>でアセットをロードすることでこれを実現できます。</p>\n<p>アセットのAssetBundle化は、プロジェクトの規模が大きくなると設定の自動化やJenkinsのジョブから <a href=\"https://docs.unity3d.com/ScriptReference/AssetBundleBuild.html\">AssetBundleBuild</a> や <a href=\"https://docs.unity3d.com/Packages/com.unity.scriptablebuildpipeline@1.19/manual/index.html\">Scriptable Build Pipeline</a> を通してビルドの自動化などのワークフローが組まれることが多いですが、簡易的には <a href=\"https://docs.unity3d.com/Manual/AssetBundles-Browser.html\">AssetBundle Browser</a> を用いてAssetBundleを用意できます。</p>\n<p>まず、アセットバンドルにしたいアセットに名前をつけます。アセットをインスペクタで開き、下記画像赤枠の項目をクリックすると名前をつけられます。</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1976f55c30e8886afbeaf7d0f0574c4c/b67f3/00.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADt0lEQVQ4y42Tv28jVRDHH1vQ0J1Egc4Qh8TYTry7b3ft/f3b9vrH4XVi0BGdhGw58SUIJSgSEQcUBglBSxYEBQVQoqSn4E9hKypIR0PB7e47zVtvzjoorvhqZmfGnzcz7xl9WJOQ9+rrLx0EW6U3xNfucrtcqdlsliRJKomiSK3jOCXLskqCINAY2HUfY3y30Wi86LouQt9+8CnyWvpHB291/zG7zp8ch29YtnHDsiwVx3E3qqreyLJ8+/2M/sIY/12pVAIKJIQg3TC+GQ7vkX5/QGzbJqZpEsuyiKZppNlsklar9b+CHNS4rksqlcr09PQ0B/I8H/m+T3zff+w4TmrbdmpZVmqaZmoYRqrrOhX4IMgVMk0zabfbAJ9eX1/nwHq9HsFJnuclmqZlsizTDj3PI1Dc6/VIEAT0GwS1iqIQVVWhNnUcBzqeXl1d5UBVVaPxeEx0XU8sy8pgZAAMh0MqyIVhSMEgyANU1/VM0zTolLAsO7u8vMyBQRBE5+fnxHGcxPO8bDU+3Y1hGMWPqQ8CwEoZrAdy5XJ5dnh4mAPZ3Z1IkVtwIYllmpmqqqQQwJ7VWj5TFCWFFW1tbc3Ozs5yoN0dRINwjzi2nfh+G8YgUAR7WhfE1uOyLNMOYQWbm5uzk5OT1bPpDKIgnBDPsZPRaJR1u10Yn45cCEaEC+r3+7cx27azIAhSiG9sbMzm83kO3N2pRx3fI3v7+xS4KqbQwhYHwC2DXcWyTqdz2+Hx8XEOFEQxard94nte4vt+Bksu9gW+JElEEAQ6JvgYY/qwYeRih9vb27OLi4scKIpiBM/Ddb1EURQKLAS3CpBmU7p9f/APKS5FkqQUYtVqdbZcLnNgrVaLBAHDyYkgCBl0U4jjWLI4fp8EvSG8NSKKItUqn4mimIIPz+bo6GgFrFajvACA+CkQY4iR+eFDYtsu4TnuaZzmhAxjnMIKALhYLHLgdrV6yWJMWB7/y/I4ZXk+zS1OGzyfOp6fis0W9Ys4iOd50GOe50m5vDFdFB3qPPd9YOika2gkMHXSswxqC3V0lUB+PQayTZPu2fb7hBXU+dc//ZYDx0Lj0Tuu9cdYl3+fWFo8HQTx27YR75tqPDG1GGLUrrRvavF9S48H7XZsmGZs2U5cre2EP/z8C0L1l+8wCKFXEEIyQshACOkr+zwqagWE0B3DfxMh8uuP6GOn9cKXkyHzSd9jPg97zHdH7zJfTIbMctRlPguD/2gZ9piv9nrMwwcHzL3RiAn37zOa1Uaz9x6hJwK3XBVJreJ5AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"インスペクター上でアセットバンドルの名前をつける\"\n        title=\"インスペクター上でアセットバンドルの名前をつける\"\n        src=\"/static/1976f55c30e8886afbeaf7d0f0574c4c/5a190/00.png\"\n        srcset=\"/static/1976f55c30e8886afbeaf7d0f0574c4c/772e8/00.png 200w,\n/static/1976f55c30e8886afbeaf7d0f0574c4c/e17e5/00.png 400w,\n/static/1976f55c30e8886afbeaf7d0f0574c4c/5a190/00.png 800w,\n/static/1976f55c30e8886afbeaf7d0f0574c4c/c1b63/00.png 1200w,\n/static/1976f55c30e8886afbeaf7d0f0574c4c/b67f3/00.png 1338w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>インスペクター上でアセットバンドルの名前をつける</p></figcaption>\n  </figure></p>\n<p>次にAssetBundle Browserを開きます。「Build」タブをクリックし、下の「Build」ボタンをクリックするとアセットバンドルがビルドされます。アセットバンドルはプラットフォームごとに生成が必要なため、対応するプラットフォームに対してそれぞれアセットをビルドする必要があります。</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ae0eb86938004d4ced4b36767fec76c4/b6425/Screen_Shot_2021-12-18_at_19.26.11.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAAB3UlEQVQoz6WPy27TQBSGDwhWWXULD9DEtzS+jMczZ2Y8Tuy4F9QixAYh1Sz6bPAybaMKyooXiYYcZCdApVQsyuLTf/5z+aUDH97IU7Tp1fjQuxx7XjeeeN3Y8zs/CLppGHbJbNYZrbp4djT4MAyHeb97OJl0E9+/nPj+VRCGJx+7TwBK4f2iqUlKJKs1Wa1II1LNM6oin+ZHIZ3kCS1mEVWRR00WD/NSIVXGkJaSNEpK4/gbADyHohC3iIqsFOuLeu7aqnSN0a5R6OaicI1Gd1rZQXtfo3SNVq4xyi1L7drSrI9tSceCXwPAS1CIK2MtqZy5WvCNKfhGpslGJPEfFcnsr0/jXW9LrdDVWlEr8hsAeAFSylXbtlRV1lmjqRowZBCHdwz+Gy2F61VwfjsE5pyvlm1L1lauLC1pY0hpQxKRhJQ7HtZ7uH43/x2Ypslq2TSklXI8z4llKbEso7yHbWEP6j2yzHHGKEmSbeCZYKv3C0sXBt25lr3u8a4yj/Z7zo10bw3Smci3gZyxGykKkqJYSyF+SlHsgfLx/o41CkGcsevty1n2vSgK4pw/naKgNMvuh8AgCL5Mp9MfURTdRVH09Qnc9fdhEHweAgHgAABeA8Cr/6C/PxiNRs9+AfvNTKjTlUmRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AssetBundle Browserでアセットバンドルをビルドする\"\n        title=\"AssetBundle Browserでアセットバンドルをビルドする\"\n        src=\"/static/ae0eb86938004d4ced4b36767fec76c4/5a190/Screen_Shot_2021-12-18_at_19.26.11.png\"\n        srcset=\"/static/ae0eb86938004d4ced4b36767fec76c4/772e8/Screen_Shot_2021-12-18_at_19.26.11.png 200w,\n/static/ae0eb86938004d4ced4b36767fec76c4/e17e5/Screen_Shot_2021-12-18_at_19.26.11.png 400w,\n/static/ae0eb86938004d4ced4b36767fec76c4/5a190/Screen_Shot_2021-12-18_at_19.26.11.png 800w,\n/static/ae0eb86938004d4ced4b36767fec76c4/c1b63/Screen_Shot_2021-12-18_at_19.26.11.png 1200w,\n/static/ae0eb86938004d4ced4b36767fec76c4/29007/Screen_Shot_2021-12-18_at_19.26.11.png 1600w,\n/static/ae0eb86938004d4ced4b36767fec76c4/b6425/Screen_Shot_2021-12-18_at_19.26.11.png 2336w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>AssetBundle Browserでアセットバンドルをビルドする</p></figcaption>\n  </figure></p>\n<p>次に、上記のOutput Pathに生成されたアセットバンドルをStreamingAssetsにコピーします。</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5f5bb970da21a80ad1713753903d9fd0/38116/01.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACnUlEQVQoz6VPyW7TUBQ1RawQSoWaLV8CC1SEALcSaikL2kKT9kcAiY9gyRKpqDEdxCCBgKbO0DZN4ikhzmTHdjwmburhxe8ih4LomisdHd17zzvvHuL5jbUpPrtzu8gczDMMT+YKR+TxCUMelqrkcalK0iWe3PuSJfc+fCbzxRJZYQTypMJNuMrWyApbIxm+Pn9S4e68ePnqMnH31uw1nqnIQl2AmsBDuVQAqdMAVW6B1mtBX5VA7orQFnloiwK0GgKYfQkcUwVb74FtKGDpPdDV7iC19vQ6sbj0aDpLF9osy0Ku3Bm//dbF2/sd/J42JqCyGqYO+pg60PHWjx7e/NrEmX0VZ7Ia3pqwGmX2e/Duu2zevreUJFZWVhN0rtAuFA+h2VEjzQlwpdbFhbKIf3YtLOkelvQzLBsebikDzDUU3O2PcM/0cUOyMd/sR0JLh4Zkm8ur6RniyfJygqbznVy+CIqiRABjUBUZ5G4bvDMXcBROABiB741A11UYIx9i3cgdgGOb0cAxY625sbGeJBYWFhP54mGnXGFAUbUoCEOQZBkaogimZUEQBOAHAcRz9/QUFEUFz/MhRAhsxwHdMCLDMGEwHJrp9fUk8WBuLnF0VOpwfA36uhFZQxea7Ta4rgtoPP5rGP4xVFXwff9377pg2XYUfzx0XTOVSiWJ2aVnCe642BQ4Hvq6GWqahkRRRKejEQqCAPnnCMIQua6L5F4PDV0XxWU7DtJ1PTQMI76wn06nZ4jHC6npKle2hHodTMsGhNAkXoQxRFF0AePxeHJZrIn3cYI4ejz3PC9MpdJJ4uH9m1c3qU+vt3c/7tI0neE4jmI5jmIYhmJZlmJY9gJP9v/0LMvGb3YYhnlDkmSCOK8pgiCu/Cdij0u/AKG8lMcOIL2BAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"生成されたアセットバンドル\"\n        title=\"生成されたアセットバンドル\"\n        src=\"/static/5f5bb970da21a80ad1713753903d9fd0/5a190/01.png\"\n        srcset=\"/static/5f5bb970da21a80ad1713753903d9fd0/772e8/01.png 200w,\n/static/5f5bb970da21a80ad1713753903d9fd0/e17e5/01.png 400w,\n/static/5f5bb970da21a80ad1713753903d9fd0/5a190/01.png 800w,\n/static/5f5bb970da21a80ad1713753903d9fd0/c1b63/01.png 1200w,\n/static/5f5bb970da21a80ad1713753903d9fd0/29007/01.png 1600w,\n/static/5f5bb970da21a80ad1713753903d9fd0/38116/01.png 2086w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>生成されたアセットバンドル</p></figcaption>\n  </figure></p>\n<p>上記でStreamingAssets以下にアセットバンドルが用意できたので読み込んでみます。アセットバンドルの読み込みには <code>AssetBundle.LoadFromFileAsync</code> などファイルパスやストリームを指定してアセットバンドルをロードするメソッドが用意されているのでそれを利用します。</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">UnityEngine</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">Cysharp<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TestStreamingAssetAssetBundleLoad</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">MonoBehaviour</span></span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> assetBundle <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">LoadAssetBundleWithFileIOAsync</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"character\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> prefab <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> assetBundle<span class=\"token punctuation\">.</span><span class=\"token function\">LoadAssetAsync</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Character\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        GameObject<span class=\"token punctuation\">.</span><span class=\"token function\">Instantiate</span><span class=\"token punctuation\">(</span>prefab<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token return-type class-name\"><span class=\"token keyword\">string</span></span> <span class=\"token function\">GetFilePath</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> assetBundleName<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">if</span> UNITY_IOS</span>\n        <span class=\"token keyword\">return</span> Application<span class=\"token punctuation\">.</span>streamingAssetsPath <span class=\"token operator\">+</span> <span class=\"token interpolation-string\"><span class=\"token string\">$\"/AssetBundle/iOS/</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\">name</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">elif</span> UNITY_ANDROID</span>\n        <span class=\"token keyword\">return</span> Application<span class=\"token punctuation\">.</span>streamingAssetsPath <span class=\"token operator\">+</span> <span class=\"token interpolation-string\"><span class=\"token string\">$\"/AssetBundle/Android/</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\">assetBundleName</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">else</span></span>\n        <span class=\"token keyword\">return</span> Application<span class=\"token punctuation\">.</span>streamingAssetsPath <span class=\"token operator\">+</span> <span class=\"token interpolation-string\"><span class=\"token string\">$\"/AssetBundle/iOS/</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\">name</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">endif</span></span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\">UniTask<span class=\"token punctuation\">&lt;</span>AssetBundle<span class=\"token punctuation\">></span></span> <span class=\"token function\">LoadAssetBundleWithFileIOAsync</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> assetBundleName<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> filePath <span class=\"token operator\">=</span> <span class=\"token function\">GetFilePath</span><span class=\"token punctuation\">(</span>assetBundleName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> AssetBundle<span class=\"token punctuation\">.</span><span class=\"token function\">LoadFromFileAsync</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ただし、前述の通りAndroidの場合は直接ファイルを読み込めないため、UnityWebRequest経由でアセットバンドルをロードします。</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">UnityEngine</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">Cysharp<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TestStreamingAssetAssetBundleLoad</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">MonoBehaviour</span></span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> assetBundle <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">LoadAssetBundleWithUnityWebRequest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"character\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> prefab <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> assetBundle<span class=\"token punctuation\">.</span><span class=\"token function\">LoadAssetAsync</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Character\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        GameObject<span class=\"token punctuation\">.</span><span class=\"token function\">Instantiate</span><span class=\"token punctuation\">(</span>prefab<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token return-type class-name\"><span class=\"token keyword\">string</span></span> <span class=\"token function\">GetFilePath</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> assetBundleName<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">if</span> UNITY_IOS</span>\n        <span class=\"token keyword\">return</span> Application<span class=\"token punctuation\">.</span>streamingAssetsPath <span class=\"token operator\">+</span> <span class=\"token interpolation-string\"><span class=\"token string\">$\"/AssetBundle/iOS/</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\">name</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">elif</span> UNITY_ANDROID</span>\n        <span class=\"token keyword\">return</span> Application<span class=\"token punctuation\">.</span>streamingAssetsPath <span class=\"token operator\">+</span> <span class=\"token interpolation-string\"><span class=\"token string\">$\"/AssetBundle/Android/</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\">assetBundleName</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">else</span></span>\n        <span class=\"token keyword\">return</span> Application<span class=\"token punctuation\">.</span>streamingAssetsPath <span class=\"token operator\">+</span> <span class=\"token interpolation-string\"><span class=\"token string\">$\"/AssetBundle/iOS/</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\">name</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">endif</span></span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\">UniTask<span class=\"token punctuation\">&lt;</span>AssetBundle<span class=\"token punctuation\">></span></span> <span class=\"token function\">LoadAssetBundleWithUnityWebRequest</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> assetBundleName<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> filePath <span class=\"token operator\">=</span> <span class=\"token function\">GetFilePath</span><span class=\"token punctuation\">(</span>assetBundleName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> request <span class=\"token operator\">=</span> UnityEngine<span class=\"token punctuation\">.</span>Networking<span class=\"token punctuation\">.</span>UnityWebRequestAssetBundle<span class=\"token punctuation\">.</span><span class=\"token function\">GetAssetBundle</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">await</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">SendWebRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        \n        <span class=\"token keyword\">return</span> UnityEngine<span class=\"token punctuation\">.</span>Networking<span class=\"token punctuation\">.</span>DownloadHandlerAssetBundle<span class=\"token punctuation\">.</span><span class=\"token function\">GetContent</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"addressablesでアセットを組み込む\" style=\"position:relative;\"><a href=\"#addressables%E3%81%A7%E3%82%A2%E3%82%BB%E3%83%83%E3%83%88%E3%82%92%E7%B5%84%E3%81%BF%E8%BE%BC%E3%82%80\" aria-label=\"addressablesでアセットを組み込む permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Addressablesでアセットを組み込む</h2>\n<p><a href=\"https://docs.unity3d.com/Packages/com.unity.addressables@1.18/manual/index.html\">Addressables | Addressables | 1.18.19</a></p>\n<p>3つ目の方法として、Addressablesを用いて対象のアセットをローカルグループに設定されたものに所属させることで、アセットをアプリ内に組み込む事ができます。</p>\n<p>この方法は、内部的には先程のStreamingAssetsにアセットバンドルのデータを組み込んでロードする方法が採用されています。</p>\n<p>StreamingAssets内にアセットバンドルを組み込みは、Unity標準でそれらの自動化は存在しないのでアプリ側でワークフローを整える必要がありますが、Addressablesによるアセットのアプリ組み込みは、ある意味2つ目の方法のワークフローをUnity標準のライブラリで整えてくれている、という感じでしょうか。</p>\n<p>実際にAddressablesによるアセットの組み込みからロードまでをおこなってみます。まず下図のように<strong>Window > Asset Management > Addressables > Groups</strong> でAddressables Groupsウインドウを開き、「Create Addressables Settings」でAddressablesの設定を作成します。</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/280a661df9ff6264d88de1ef06394e23/26a94/02.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABo0lEQVQoz43R3WvTUBjH8fxFJrVJk7RrG0rSpODdpG5t15aWraAwUHSCF96K4IU3A28H7mowZYMxquytY+22zOEY6tqZ0iEMX0CHf8BXToSCCNOLDwfOc87D8+ORFptndPY+EXy8YHvziDt3b1OfvEm5UqNUqlKaqP4+S1Vq9Slq9Qblcp1CsUKxWA0VQpWQdNDp4u8G9E4uaK76JJMjaJqKoijI8pWhSERBVaNhLRq9iqLIfxFvJH+vz6E/YBD8pLm6j5t1cV2XXC6H53lD2ayL5+WG97ZtDzmOg207ZDIZpPeHAW87Hzjvf6e9cYCh68RiGoZhkEqlsKw06XSaRCKBaZqheDz+B1ETxB9pbeuM1+untHa/srB0xPh4kXw+z+jodVRVRVZEVA1d1/+L1GoN2Nw4Zad9zsLSMfcfPefB43luPZxjYvoJhemnpOxrxLQohmGGU1xG6vkndPe7fOl9ZufVNmY8gaxEcByX2dlnvHyxzNiNsXBJIq6Y4tKGx+139N4EfOv/YH1li+SI2LKGZVk0phrM3JsJlyTi/2s60fAXKEhUXFKdHBwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"メニューからAddressables Groupウインドウを開く\"\n        title=\"メニューからAddressables Groupウインドウを開く\"\n        src=\"/static/280a661df9ff6264d88de1ef06394e23/5a190/02.png\"\n        srcset=\"/static/280a661df9ff6264d88de1ef06394e23/772e8/02.png 200w,\n/static/280a661df9ff6264d88de1ef06394e23/e17e5/02.png 400w,\n/static/280a661df9ff6264d88de1ef06394e23/5a190/02.png 800w,\n/static/280a661df9ff6264d88de1ef06394e23/26a94/02.png 1102w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>メニューからAddressables Groupウインドウを開く</p></figcaption>\n  </figure></p>\n<p>すると、下図の用にグループの設定が作成されます。このとき「Default Local Group」というグループに所属するアセットは、アプリ内に組み込まれてロードされます。</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2e4d2e64491c1b1e238e0ff1cb30e125/1be7e/03.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTUlEQVQoz6XRXU+DMBQG4KM3Go33XDHUDNJuFMJW2tLBkJn4sSs/lmhi9Td6q9nfUuc2akowbiZGNy+eHDgNbzktXLjh3uUwvaEZv/f94A5jrNrttmq1WpUwDJWUUiVJooIgUAgh5fu+IoQsuiOEPGCMLQhxOzw/O9Gnw6HOjwrNGNOU0kq3262qEEKnaaqllNVzFEXa931NCFnSbDavwDnY7+R5/no8GJRFUcz6/f48SZJ5lmVVNaSUS0xPCLFoajbyPG8Etm1HnPM32euZPyiFECVjrIzjuKp/NDeTua47AsdxOpTSiWnUi5pzvoqSc/4V2Gg0OnEcTxYW9Wdovclvfg5cYcQl3wMjSulL3ZwyxmZreK8Dr80ZUvNibuk/zISe592CZVmHCKFHhNAYIfSEEHpeB8Z4bNt2AgCwAQBbALALADtrMt9uA8DmByMOIdT1bPFIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Addressables Groupウインドウ上でのDefault Local Groupの確認\"\n        title=\"Addressables Groupウインドウ上でのDefault Local Groupの確認\"\n        src=\"/static/2e4d2e64491c1b1e238e0ff1cb30e125/5a190/03.png\"\n        srcset=\"/static/2e4d2e64491c1b1e238e0ff1cb30e125/772e8/03.png 200w,\n/static/2e4d2e64491c1b1e238e0ff1cb30e125/e17e5/03.png 400w,\n/static/2e4d2e64491c1b1e238e0ff1cb30e125/5a190/03.png 800w,\n/static/2e4d2e64491c1b1e238e0ff1cb30e125/1be7e/03.png 1059w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>Addressables Groupウインドウ上でのDefault Local Groupの確認</p></figcaption>\n  </figure></p>\n<p>念の為、「Default Local Group」が組み込みアセットの読み込み設定になっているかを確認しておきます。</p>\n<p>Addressables Groupウインドウのグループをクリックするとインスペクター上でグループの設定が確認できます。下図のようにDefault Local Groupの設定のContent Packing &#x26; LoadingのBuild PathがLocalBuildPathに、Load PathがLocalLoadPathになっていれば、組み込みアセットからロードを行います。</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 524px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/830906f40033efe577b912a3cd1d2ec5/664c8/04.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 79.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB30lEQVQ4y3WT6Y6CQBCE54VE1HjgheABiIp3stn9YWJ8/0fozTduEbLZ/VFppumurq4B97VK7eNzaYP13MKwa0HQsiAIarTbbZvP5xbHsXU6HWu1Wj7XhOp47/L90YqysrLc2SiKfLLX61m32/VRaJ6pgSAMQw/Oo9HIhsOhuer6YYcisyRNbLVa2WazsSzL6pjneX1WbrFY2Gw284iiyMf7/e7fuSLPbZu9iykcj8c2mUxsOp36CMgJECiXpqmdTieP5/Npl8vFHP4kaWrL5dLi+D2ZBho1Hf8ABCBJEj8cRfv93rbbrRVF4UU5JlEMMUUUQ9jv970nEGhlFKDmeDz6eLvd7HA4eKvW6/WbkNVQpwSRApQNBoNaJXWyA+gSiLIBvx0HSCSbJKpoRiXPVVXVkDqGI0QQh2M6igSpxAYUQowd8lWXg+ImqEGQowkizIUMRTSzDgoper1e9ng8vGdlWXolv0H/brczhweaiAIGyBueuSTZQWx+m02gEDGOZq3NmhAJUs/tXq9XO5/PnvgviNhJjW4NkiYhhkOEOp4ZQEx/vl3Oeq4Vsq6SfItaW+RYIU/J/YbesbYnxEMUYPhf/y65JsixJgL0TyMKMZ4Q0KxiXQJgyH832xwAWP8bQoAxl18yVnkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"グループ設定の確認\"\n        title=\"グループ設定の確認\"\n        src=\"/static/830906f40033efe577b912a3cd1d2ec5/664c8/04.png\"\n        srcset=\"/static/830906f40033efe577b912a3cd1d2ec5/772e8/04.png 200w,\n/static/830906f40033efe577b912a3cd1d2ec5/e17e5/04.png 400w,\n/static/830906f40033efe577b912a3cd1d2ec5/664c8/04.png 524w\"\n        sizes=\"(max-width: 524px) 100vw, 524px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>グループ設定の確認</p></figcaption>\n  </figure></p>\n<p>次に、アセットをこのAddressablesのグループに所属させます。対象アセットをインスペクターで開き、赤枠の「Addressable」のチェックボタンをONにします。合わせてこのアセットのアドレス（アセットを読み込むときに指定する文字列）を指定しておきます。</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 730px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0b91cfdbf36580c94bd8c802ac44b610/e9beb/Screen_Shot_2021-12-19_at_6.04.07.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACgklEQVQ4y52TzWvUQBiHZ7VawXv1JohN23zNxyaZzG4mmWw23Tb9kIqWfiBV0FooKHjw//DiyasIgncV7Ar+K57K3qpLYXfzarbsR2kV6cDDZN73Nw9DJkE/FmK0PTN9c23t9uwtqmnMJhqhRCNkRJIkWi2ONYzxqfoA27ZnCSE3sixDCABQVpUfV+/VwJHVI2zZbdsew7LaPudtz/PalmWd7p1wRCkFwzDeHx8fo2JMViL1rbG4BEma5lUpQUZRHy4EeL5/Li7n4LkuOI6TK6XA9/0vCKErhfDac3znYD/isBe4nSc+zR85Vr5lz+RbtpZvWlq+YU732bK0fNOeyXfs6fyxYHkjy/KV5eVOmqbged4nhNDV/gmXqNlcCwTcrfDuqnAh8xis+C6s10LYSBTsLDXg4ULaXz9QEjKHQMNzQIYhxEp1gyAAxtjnodDxRVPVEvBEpev6AjwhoCIlqCSBqFaDUCmIkwSKTLHm1Wo/43MOnPOu7/tQLpdHQtMwmoxSoIR0KSHFDIQQsC0Lihf+4uUruL++DaZpAsYYxjOk2EMp6Lo+EhqG0SyKg2YBYwws04SknsLrN29hfXMHKGUw6A8Y7DEM49/CAsuyIFIKdvf2IZCqLyxO9d9CSukpoW3bIKWEp7vPQIYRMFY+I6T0HKGu6wdFEGPcIYT0BmCMe4yxnoqinuM4w9oog3uYkA4hGPS52dFnQyn9XtwUP7m1M7iu+9ce9zwQlQCoF34dCjnnH+I4/imEOJyfn2+ladqSUrbCMOwTRdHweZx6vd6K4/hQxbVfIlDvBn/KBEJIL5VKixfj0mIJoQWE0FxpYnICTU1NobFRuiAIXRfo8p/5N+7JeWkFrbgIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"アセットのAddressables設定\"\n        title=\"アセットのAddressables設定\"\n        src=\"/static/0b91cfdbf36580c94bd8c802ac44b610/e9beb/Screen_Shot_2021-12-19_at_6.04.07.png\"\n        srcset=\"/static/0b91cfdbf36580c94bd8c802ac44b610/772e8/Screen_Shot_2021-12-19_at_6.04.07.png 200w,\n/static/0b91cfdbf36580c94bd8c802ac44b610/e17e5/Screen_Shot_2021-12-19_at_6.04.07.png 400w,\n/static/0b91cfdbf36580c94bd8c802ac44b610/e9beb/Screen_Shot_2021-12-19_at_6.04.07.png 730w\"\n        sizes=\"(max-width: 730px) 100vw, 730px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>アセットのAddressables設定</p></figcaption>\n  </figure></p>\n<p>設定が完了すると、下図のように「Addressables Groups」のDefault Local Group配下にCharacterアセットが追加されていることが確認できます（今回は１グループのみかつデフォルトのグループ設定としてDefault Local Groupに所属しましたが、そうでない場合はアセットを右クリックして「Move Addressable to Group」で所属するグループを変更できます）。</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c3d0f4c275eff87ea09cec58e6a02d24/1be7e/05.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABdElEQVQoz6WRTU/DMAyGDRcQiPtO2wDtI1mbdbRJ2yTt2oFUMU4gkECi8Bu5gva3+G6NEor4EBfG4ZH9OvZrRYbjvrd1cpSc8zS+ct3xJaW0dBynHI1GNnqeV2qtSyllOR6PS0JI6bpuyRj7yiVj7JpS2gKPOt78sMBiPscsyzEMQ+ScI+cB+r6PQRDYmtYalVIopcTJZIKO4yBjDF3XtZi81+udwPbOjp/PZg9FUdQHB/uv0+m00lpXWT6rTJ6maZUkiY1GZ1lmtemRUn7wEscxDofDM+h0OntKqcc8zzFJklpKWcdxXCud1Gma1qZmokEpZTE1rbXta6iiKMLBYGAN/SAInoQQKISozffesfobn2/fMDOVyfv9/ruhEOLJbIiiqG7iXzAzvxs22/7MT8M9zvl9U3wJw/B1CZ4bw1PodrvcCHOl/9Ac5QJardYuIeSGELIghNwSQu6WgVK6aLfbEgBgBQDWAGATADaWxMyuA8DqGxcHIwUJXFCuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"アセットがDefault Local Groupに所属しているかの確認\"\n        title=\"アセットがDefault Local Groupに所属しているかの確認\"\n        src=\"/static/c3d0f4c275eff87ea09cec58e6a02d24/5a190/05.png\"\n        srcset=\"/static/c3d0f4c275eff87ea09cec58e6a02d24/772e8/05.png 200w,\n/static/c3d0f4c275eff87ea09cec58e6a02d24/e17e5/05.png 400w,\n/static/c3d0f4c275eff87ea09cec58e6a02d24/5a190/05.png 800w,\n/static/c3d0f4c275eff87ea09cec58e6a02d24/1be7e/05.png 1059w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>アセットがDefault Local Groupに所属しているかの確認</p></figcaption>\n  </figure></p>\n<p>これでアセットの設定は完了したので、実際にロードしてみます。ロード自体は非常にシンプルです。</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">UnityEngine</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">Cysharp<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">UnityEngine<span class=\"token punctuation\">.</span>AddressableAssets</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TestAddressablesLoad</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">MonoBehaviour</span></span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Addressablesによるアセットのロード</span>\n        <span class=\"token comment\">// awaitはUniTaskで提供される機能を利用しています</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> prefab <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Addressables<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">LoadAssetAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>GameObject<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Character\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// ロードしたPrefabをインスタンス化して表示</span>\n        <span class=\"token function\">Instantiate</span><span class=\"token punctuation\">(</span>prefab<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>今回の例では、名前を直接指定して<code>LoadAssetAsync</code>メソッド経由でロードしましたが、その他にもアセットにあらかじめ設定したラベルを指定して、複数アセットを読み込んだり、<a href=\"https://docs.unity3d.com/Packages/com.unity.addressables@1.18/manual/RuntimeAddressables.html\">その他にもAPIが存在します</a>。</p>\n<p>あとは上記のコンポーネントをゲームオブジェクトにアタッチすればアセットをAddressables経由でロードして表示されます。</p>\n<p>方法2と比べると、StreamingAssets配下であることは隠蔽されているので、2つ目に紹介したようなプラットフォームごとの呼び分けを意識する必要がなく（さらにいうとアセットがどこにあるのかも意識していない）、より直感的にアセットのロードを行うことができるようになりました。</p>\n<p>アプリ内へ埋め込むアセットバンドルのビルドとStreamingAssetsへの組み込みは、ローカルアセットの場合はアプリビルド時に自動で行われるようです。例えばapkをビルドして、生成されたapkを展開すると、 <code>assets/aa/Android</code> 配下（StreamingAssetsに格納したアセットはこの <code>assets</code> 下にコピーされる）にAddressablesが組み込んだアセットを確認できました。</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/52d9a902501b38b0276fd3e7a1eb4f71/434c7/06.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACJ0lEQVQoz5XQS27TQBgAYK9ZI3EGLHasUbkE3nCC3KBcoEJll4guGRYcgZDm4aRpk4aSNKFVbJyXXecdjx0/k9ieeH4Ug0CCINTFp380/2P0D3NTKT3t99ofpE7nndBuI1lW0GAgI1lRUL/fR7diBzVbX1Gr1UKSJKFut4e63S5SFAUNh0M0HI7QeDx+r6oqOj3NPmJ4vvhSEERQ7lToDQagLeZgmgZYlgnm0oDlL3ocTXMJ8/kMJuMROI4NtmWCoWPAWINM5tMTpsCXXtTr1zCazAN54RJ1ionl+sRdk784u7jZEt30yBxbxFmFsYXhELx0t5kc/5jJ5niu2WyC0JtGFdGhZ407Wv+m04Zk0OuOQRsSplcCpqWWRi9Fi37perQmmrR6u6BXkkNrok0v2xgubjRIoTTLlPgSJwoS6LoRTTSdLrQFEBJAGO5HSAie54Jh6BAEPmw2a7r7np18Ps8y1TOe60kijGZapM40ul6tIAhD8P0A/OAPfhDnbMcB3TDiu43vU9O0wHFdKBaLLFMsX3CCKMFsjiPdtKjneRCGYdy4zy63Wq/jAUEQPxD37BQKBZYpl6ucKHYAY30bRVu6Kwj/h5AfwjCuJ4RQ3/chm82yTK32mVMUFbBuRGS7/V38D2TPmRASr5/L5Vjm/LzC9fsyTKYz6npevIp7X54Htm3Dx3SaZQ4PXz08Onr9/Pj4zUEqlTpIJpP387Pn7cnJs0Qi8eA7Kqn30oX0xEQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"apk内に組み込まれたAddressablesのアセット\"\n        title=\"apk内に組み込まれたAddressablesのアセット\"\n        src=\"/static/52d9a902501b38b0276fd3e7a1eb4f71/5a190/06.png\"\n        srcset=\"/static/52d9a902501b38b0276fd3e7a1eb4f71/772e8/06.png 200w,\n/static/52d9a902501b38b0276fd3e7a1eb4f71/e17e5/06.png 400w,\n/static/52d9a902501b38b0276fd3e7a1eb4f71/5a190/06.png 800w,\n/static/52d9a902501b38b0276fd3e7a1eb4f71/c1b63/06.png 1200w,\n/static/52d9a902501b38b0276fd3e7a1eb4f71/434c7/06.png 1381w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>apk内に組み込まれたAddressablesのアセット</p></figcaption>\n  </figure></p>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>アセットをアプリに組み込んで、利用する方法を3つ紹介しました。</p>\n<ul>\n<li>Resourcesによる組み込みはアプリ起動時間の増加やメモリ管理の観点から、ライフサイクルが永続的かつ頻繁な更新が行われないアセットに限定した利用用途の限定が推奨されている。</li>\n<li>StreamingAssetsを用いると上記の問題を回避してアセットを組み込める。ただし一部プラットフォームではアセットの読み込み方法が異なるので注意が必要。\n<ul>\n<li>StreamingAssets内でプレハブなどUnityのアセットを読み込む場合はアセットバンドルを埋め込む必要がある</li>\n</ul>\n</li>\n<li>Addressablesを用いるとStreamingAssetsへのアセットバンドルの組み込みとロードを、それらのワークフローをあまり意識することなく実装できる。</li>\n</ul>\n<h2 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://learn.unity.com/tutorial/assets-resources-and-assetbundles\">Assets, Resources and AssetBundles - Unity Learn</a></li>\n<li><a href=\"https://tsubakit1.hateblo.jp/entry/20120917/1347807947\">StreamingAssetsについて - テラシュールブログ</a></li>\n<li><a href=\"https://light11.hatenadiary.com/entry/2020/07/29/202755\">【Unity】僕はそろそろResourcesフォルダを卒業しようと思う - LIGHT11</a></li>\n<li><a href=\"https://light11.hatenadiary.com/entry/2019/12/26/225232\">【Unity】Addressableアセットシステム入門 - 3つのメリットと基本的な使い方を紹介 - LIGHT11</a></li>\n<li><a href=\"https://qiita.com/k7a/items/df6dd8ea66cbc5a1e21d\">今更誰も教えてくれない、Unityにおけるアセット読み込みについての基礎知識 - Qiita</a></li>\n</ul>","excerpt":"この記事は「Applibot Advent Calendar 2021」の20日目の記事になります。 Unityではアプリ内にアセットを組み込む方法がいくつか存在しますが、それぞれの方法で利用方法や実装上の注意点があります。 アプリ内にアセットを組み込む方法には大きく分けて下記があります。 Assets/Resources というフォルダを作成してその中にアセットを格納する Assets/StreamingAssets というフォルダを作成してアセットを格納する Addressables…","fields":{"slug":"/articles/2021/12/built-in-asset-for-unity/"},"frontmatter":{"date":"December 20, 2021","type":null,"tags":["Unity"],"title":"Unityでアプリ内にアセットを組み込む3つの方法","description":null,"eyecatch":null}}},"pageContext":{"id":"e66892c7-ce5b-5c21-993f-2da8114e5a59"}},"staticQueryHashes":["1480509143","3159585216"]}