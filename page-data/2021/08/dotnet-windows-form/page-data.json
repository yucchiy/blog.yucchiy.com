{"componentChunkName":"component---src-templates-post-tsx","path":"/2021/08/dotnet-windows-form/","result":{"data":{"markdownRemark":{"html":"<p>タイトル通りで、.NETアプリケーションでWindowsフォームを利用してウインドウを作成する方法をメモします。</p>\n<p>手元の環境は下記のとおりです。</p>\n<ul>\n<li>Windows 10</li>\n<li>Visual Studio 2022 Preview 3</li>\n</ul>\n<p>.NET 6 Preview 7での動作を確認しています。</p>\n<h2 id=\"プロジェクト作成\" style=\"position:relative;\"><a href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E4%BD%9C%E6%88%90\" aria-label=\"プロジェクト作成 permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>プロジェクト作成</h2>\n<p>.csprojを作成します。テンプレートには下図のように.NETのConsole Applicationを指定します。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6ffdb9b4bcad5e8491773fb2583ea831/2bef9/2021-08-17-06-01-02.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABvElEQVQoz32SW2vbQBCF/f//T1/zUqcUmpIQmiiOKbYjW7K02vt1LnKK1lAKbfqxLAPL4cyemRUimor33lq7VNZipQCUUgCRiIkYEBGQiJanUgBgBQBd3/V9PwkxDkPXHYfhjEQAkFMuORMiE8+8HAQgQmaaZyaiFQBKqadJTVKNQuYMAFQAci5Sm5ihIFsfXUjI7xlIW7/UVMUxprv7p293T9/vm6fn3eu2bTZ7pf3P0/Tptrl5ON48HNeNXL/IdSO/bPTtRn1+Mdvez4RL20opY0yMoZTMzKXA+4VbEb8258dt9/DaPR+m5k29tOpHGx6P6f6Q2ildmFaIqLW21sYYc85EVEq5XC5a691uL8QoxOis8c56Z2PwMYSS0xId4iJOlRBCSukqrv5lHEXX9aMYtTHOLbNwzkMNHKCKiYj/gCrMnFI4de3b4e10OimlpJSqorV2zpXf4r/hmYIjcQ5SCiFE9VywlVLKdRE+EDPlSP1JHQ77tj12XTdNk6xc04X/OC+/QpBaDedhGM59xXsfY5xnnuf5umcfOXPK2ZhlBCHEegcAiDEZ4+oiO6aPnflfxBhr5MvA9mf5C/5I43WxoxvKAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2021 08 17 06 01 02\"\n        title=\"2021 08 17 06 01 02\"\n        src=\"/static/6ffdb9b4bcad5e8491773fb2583ea831/5a190/2021-08-17-06-01-02.png\"\n        srcset=\"/static/6ffdb9b4bcad5e8491773fb2583ea831/772e8/2021-08-17-06-01-02.png 200w,\n/static/6ffdb9b4bcad5e8491773fb2583ea831/e17e5/2021-08-17-06-01-02.png 400w,\n/static/6ffdb9b4bcad5e8491773fb2583ea831/5a190/2021-08-17-06-01-02.png 800w,\n/static/6ffdb9b4bcad5e8491773fb2583ea831/2bef9/2021-08-17-06-01-02.png 1024w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"プロジェクト設定\" style=\"position:relative;\"><a href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E8%A8%AD%E5%AE%9A\" aria-label=\"プロジェクト設定 permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>プロジェクト設定</h2>\n<p>下記のページを参考に設定します。</p>\n<p><a href=\"https://docs.microsoft.com/ja-jp/dotnet/core/project-sdk/msbuild-props-desktop#usewindowsforms\">Microsoft.NET.Sdk.Desktop の MSBuild プロパティ - .NET | Microsoft Docs</a></p>\n<h3 id=\"概要\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81\" aria-label=\"概要 permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>設定の要点としては下記のとおりです。</p>\n<ul>\n<li>(.NET 5以降の場合は) SDKターゲットを<code>Microsfot.NET.Sdk</code>とします</li>\n<li>TargetFrameworkを<code>net6.0-windows</code>に設定します</li>\n<li>WinFormsを利用するために<code>UseWindowsForms</code>を<code>true</code>に設定します</li>\n</ul>\n<p>.NET 5以降とそれ以前では設定が違うようですが、詳細は<a href=\"https://docs.microsoft.com/ja-jp/dotnet/core/project-sdk/msbuild-props-desktop#usewindowsforms\">ドキュメント</a>を参考にしてください。今回は.NET 6を対象にしているため上記の設定としています。</p>\n<h3 id=\"csprojを編集する\" style=\"position:relative;\"><a href=\"#csproj%E3%82%92%E7%B7%A8%E9%9B%86%E3%81%99%E3%82%8B\" aria-label=\"csprojを編集する permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>.csprojを編集する</h3>\n<p>概要に示した設定を行います。Visual Studioでの設定を記載しますが、直接 .csproj を編集でも問題ないはずです。</p>\n<p>まずSDKターゲットですが、確認のためには.csprojを直接開いて確認します。Solution Explorer上でプロジェクトをダブルクリックするとそのプロジェクトの.csprojを開く事ができます。</p>\n<p>開くと下記のような設定が確認できます。ここでSDKターゲットは、1行目の<code>&#x3C;Project Sdk=\"Microsoft.NET.Sdk\"></code>の<code>Microsoft.NET.Sdk</code>部分です。</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Project</span> <span class=\"token attr-name\">Sdk</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Microsoft.NET.Sdk<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PropertyGroup</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>OutputType</span><span class=\"token punctuation\">></span></span>Exe<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>OutputType</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TargetFramework</span><span class=\"token punctuation\">></span></span>net6.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>TargetFramework</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Nullable</span><span class=\"token punctuation\">></span></span>enable<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Nullable</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>PropertyGroup</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Project</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>テンプレートのデフォルト値でSDKターゲットが適切なものなっていることが確認できました。もしこの設定が違う場合は適宜設定が必要です。</p>\n<p>次にTargetFrameworkですが、上記.csprojの<code>&#x3C;TargetFramework></code>の項目を<code>net6.0-windows</code>に変更することで設定できます。</p>\n<p>この設定はVisual StudioのGUI上からも変更できます。.csprojのGUI設定画面は、下図のようにSolution Explorerから「Properties」を選択することで開けます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 398px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5816be44f7e91afd0b3f6e31e9d1477b/692d4/2021-08-17-06-19-00.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 178.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAIAAAAGkY33AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFUUlEQVRIx31UW48cRxmdN/8BK4kiBfEIUlBekXiKxBs4G0XhiQcjHkBIoIgIgSAkRgnkggPCiZIHB9trgxIIIig4RLkoWCjOeidX8O7szHRdu6q7urv6XlVd3T2Xnah31tnsepejT6PWtE5/55yvvuo99hb99kvg5F/hd15GJ19GKxfHJ1a7Wrno3HsJnFgdrVwar1wcnbgw/Mb54f2XRt/60+iRt8XKPfceP368d27Ne+wt99dvkEdfh7/8x/CHfxs98Irz41ecH7x4/Xt//uSBv4+//+LGd18aPfgq/ull8rPXyM//RV5Yj+9Zkk1etKo0aSwQ9Ry3iIRJZB74IcU+AioKEiF8T06tXTRdTY1atJNvnljpyFImQogsTRMp8yxLZJwmaZamRZZvz+fb8/l8Nmsn8+l0OptOt2ezNI6NsSsr99166y094MXvXB30N9GVj8f9IXv3f+Cd9wdvXNtYG9CrG+jKx86b165/CMSWKAZ+PvCzDS+jaXP33V8/duxY7+RfnC8/ff3pt+HZ/6Dn/w3Or7mr6/zsVffcun9+3f/jGn/hPXZ+3b/QFxf6YrUvzl7zX92IL//z8unTp3tRpliU+JypWAQEmSxabE+2t9vFvF3Mm8V2u9ie7Dzv1WxSLxYLKWVPa11VxlRWKe0AiDDJS20qq02ljVWmUt3DvlLaNE2DEOoppU2H7gvAAWEY1U1T7cHejKqqJpMJIWSXrE1ljKGEEIwJoa7rEkwIJhiioizruj5AbtsWALBLbmpbaYUwTtPMVpXWSzlmx1R1RGfaK0vd1tWmm0KeUIwwJnXdNE19uOIDZKW6wDJlS22F73POwzDMs/wzqdVNMMa0bdt5Lktt6zoQfuB7S6uUUiGCsiyVUkVR/H/ZqmnbwdYQI+zvdGbU5ZyDsUOpixFOkrSu7eGdl7KT0mal7qLuQu6guxTrpfgjZSvVJWsr29aWc55luer+0tbapu7oR3mGEHaea2t9mfFAAseJoiiJYyljKWUUhUmSHpU2hKhXFKqxNfFj4ApGKUIIAYggJBgjCIMgtLY+lEwp7TEmxiOilG6sGY8dABwEEcHYGTtCBMYYpdSRaScyHo2GeV4arQkhQgjOuMsYRhh2QGEUHchsLzCHBpuOOxgM3G68wnUpxpi5DAIopZzOZjcfbGPMruwPrqOrH46kjLUqIYSMsXIHed7FfmCzKmvrphvBZDIBAPYIZv3+RyKMqsr4npckyYE+B5DneZqmdV1jjHtpWnIv4C5LwpBzTx22Rjc+ZJum6RJxWdM0lLq9NCk8ESSeX0rZ3SQI5Xl+wOfnyDVnLE2z+XzWBZZlZRwnnu+HgWC8Qze2fZfJ3p1S11ZGUVmqyfTGPi9fGa0545RQxpjvi9rWbds2O/Esfw8ZldZm54U1Wrk7E6KEQgiFEIEQURRJGXmen6Zp27bL/nuHJIok56wolTWGui5wHAgAcJytwdZoOAIAYoSGgy0AYFEUny3ZLhlA/N7atSAItSoDEXice5wzxsMwCMNQyjgKozRJhC+66+3GIdmVXRWpSiJCqC8E59x1XYwQY6xbyabpTO+3va9zHyUfkBSLLM1yAAHZMcxdRjAF3ZqAJM1sXZuqG1W1rzPtfeV3//3S6U9e6w/zkAEAGGMYwvHWls95ZbQqC6NVZfSyjFZ1t6LVdNpihHpfvOtrd9z51ctX3mf5fNMtNmgBoprrBVcLYRaiWvhmr0S1cAKzxUokJ5tE9r5w+2133HbLj37y0ONnzj38+JlfPPr7U799/slnV5945sLN9eSzq7966rmHfvOHU089d+qJZz4F98duy9mPR+oAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2021 08 17 06 19 00\"\n        title=\"2021 08 17 06 19 00\"\n        src=\"/static/5816be44f7e91afd0b3f6e31e9d1477b/692d4/2021-08-17-06-19-00.png\"\n        srcset=\"/static/5816be44f7e91afd0b3f6e31e9d1477b/772e8/2021-08-17-06-19-00.png 200w,\n/static/5816be44f7e91afd0b3f6e31e9d1477b/692d4/2021-08-17-06-19-00.png 398w\"\n        sizes=\"(max-width: 398px) 100vw, 398px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>設定画面から下図のように「Target Platform」項目で「Windows」を選択することで、同様に<code>net6.0-windows</code>を設定できます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/260d2c12facce83e7fffd7db2ae46add/58bb7/2021-08-17-06-20-35.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABPUlEQVQoz4VSy27DIBDk/6/t97SHfkXTJnEMNixvWC+4twocRVXrNKMRrNDOMoxgXJlJO5uo1PWrFioFqWKpbX1E9vz6+fxyeHqb3lUGKY7H0/l0AlC1lEL0P5kEM0nIuCxEzjnvfVM14WMwUJBzJqJSimxQRISIS5v2SOysu4kBYBxHY0yMMaVERMuylPsuWFddmwBgGAalABFTStuInDN2/PXCtqNNLDgXfDRaG2O01tBhrY0xhhAQcV9MPT0bUDk0sQ2qna2o275j/nZzD0xpqW1IuXnNGFuBdD841qNq8lLrceCXSWkfpQ3g4kW5w+zXej8wrZ330fuU8yK4sMbUPmz7Bt6HEFKMeZfsPIzDRUyzcj6OXIDWdV1Lre2t6zorPUtjjNN6h2yW6saPgZ+FEuC4slfO8LPhF78BCPLbGkrbvvsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2021 08 17 06 20 35\"\n        title=\"2021 08 17 06 20 35\"\n        src=\"/static/260d2c12facce83e7fffd7db2ae46add/5a190/2021-08-17-06-20-35.png\"\n        srcset=\"/static/260d2c12facce83e7fffd7db2ae46add/772e8/2021-08-17-06-20-35.png 200w,\n/static/260d2c12facce83e7fffd7db2ae46add/e17e5/2021-08-17-06-20-35.png 400w,\n/static/260d2c12facce83e7fffd7db2ae46add/5a190/2021-08-17-06-20-35.png 800w,\n/static/260d2c12facce83e7fffd7db2ae46add/58bb7/2021-08-17-06-20-35.png 985w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>最後の<code>UseWindowsForms</code>ですが、こちらはGUI上の設定画面がデフォルトでは表示されていないため、.csprojを直接編集する必要があります。</p>\n<p>下記のように<code>&#x3C;PropertyGroup></code>項目内に設定を追記します。</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Project</span> <span class=\"token attr-name\">Sdk</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Microsoft.NET.Sdk<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PropertyGroup</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>OutputType</span><span class=\"token punctuation\">></span></span>Exe<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>OutputType</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TargetFramework</span><span class=\"token punctuation\">></span></span>net6.0-windows<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>TargetFramework</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token comment\">&lt;!-- これを追記 --></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>UseWindowsForms</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>UseWindowsForms</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Nullable</span><span class=\"token punctuation\">></span></span>enable<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Nullable</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>PropertyGroup</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Project</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>これで設定完了です。プロジェクトを設定を保存して下図のようにSolution Explorerの「Frameworks」内で「Microsoft.WindowsDesktop.App.Windows」のような項目が確認できたらOKです。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 343px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c1184f5710fd40ca181e6918c8bc7c2e/41431/2021-08-17-06-26-09.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 134%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAIAAADzvTiPAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAENElEQVQ4y22TW6vcVBiG5yeItor3FqUWFbyQCuKdl4LXXuh/sQdFbLVYi1I8QOsWseCFFlGptqUHnX2YTLLOh8xMZnLOJJOsrMxkz54tybRUyrx8hBDWk/Wu7/1W582v8MlL6NXP4WuX8BuX6fPnrCdPGUfP9I6cNp4+az5z1jx6pn/0tHHktPnEB8ZTp/aePLX37NnesU/M45+anW3md2lwH7s3+/avN8Hv/7LrXXEXuX/u8J9v9a7d2L5+D9407J9uo192xtsi2RZxUzLZkUknS1I1y7Nk6k0mY+EmQRy63ixJIs8PPd+fTELXK9LMGYcjL1tU84Wual3pvMinWcdzfddzkyQNgzCJo+l0GgZBHE+TOImTtK6Xq9XhwcFqtVotlwd1vazr5XK5StPMdf2O50f3b/U4l0YfMDnEVPQtbFoAQjxynOFwOLBtCCBCOJvNVKuiKLTWaTrrvHUZnrxgvf0teuc79O4Wfe9H/v4P5PWL/ec+2j5x3jhx3njxXO/Yh90XPt596YL1cluvXLCOfwYu30Cda0ZwddvZ+mdw8bfe13+Bb/5GW3fwF3/AL2/J73eDKzv+1d1gay9s3re9B9V1r+wGtw3RWdX6YK6KJMxCd0DhkOGRYP5QLlR6eLA43K8Ol4/Xal8fHtbOyOlks0JXcz8M4+n0zt17ECHLAqYFx66ndFXqSpValbooy0KpQjXPvGgQaY86D0+fRlFEKcUIUkI4F4QQ13XDMJy2yvO8qirdqtR6sVgMBk6nKFRZqvl8niRJURTdbhcCYEvJuQCmiRCilJr9vhBSKTWbzbIsS6dpWSppD5udy7LUWsdxHEVRb28PQcQZQwgTjAkmjFJCCAAQQQQsQDDGCDNGAcAP4LW01kopSilvhREy+1aeF1WrxnC7RldVXddr249gpVRZlmuMUU4JoZRRSvuGIeVAqYYsiiLPc631I9v/5zFGCAKEMLQsQigAYKfbZYzbthRCFKpp0P5+PRg6j8NlWRJCCMZS2IJzyhjnnFJKMLZtORqNhqPRwLaHwyFCdAMsBEcQCi4ZIZhQRhklxDItACCEkDHm+36SJJSKzbabbgPYoJQCC0ghJhPX8zzP9YIgXNT1fl3neb7RdpsGQsPRiFNqmUAKGUdxlmVhGCZxEviB57lpmm2AOefrhKW0m14TJoSwpXScMWeMYCKElFJEYbTBNoTNhJr9PqXM6vcRIusI1yvnD1VV1SbbuBHBWAgBLNB2GlNCoAWABTzfX/9IKbXRNkOoOTPn3OgZlJA2L44xZoQSTDhr+h8GwQbbCEHSZGNSyiAACLYCAGMynaaqnbA8zzfvTGmTUDNSciAEl0L4QTCfz9uhrvTDW6B1uQFmlCKEEESMcdw2T0rbGTmOM4qieH09Wo+b4HEjx23Hwh1PPM9rP4wn7iRJkvXN01onSfofQPaC0Fh4fFAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2021 08 17 06 26 09\"\n        title=\"2021 08 17 06 26 09\"\n        src=\"/static/c1184f5710fd40ca181e6918c8bc7c2e/41431/2021-08-17-06-26-09.png\"\n        srcset=\"/static/c1184f5710fd40ca181e6918c8bc7c2e/772e8/2021-08-17-06-26-09.png 200w,\n/static/c1184f5710fd40ca181e6918c8bc7c2e/41431/2021-08-17-06-26-09.png 343w\"\n        sizes=\"(max-width: 343px) 100vw, 343px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"動作確認\" style=\"position:relative;\"><a href=\"#%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D\" aria-label=\"動作確認 permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>動作確認</h2>\n<p>設定が完了したので、空のウインドウを作成して動作確認してみます。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">System</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Drawing</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token namespace\">ConsoleApp2</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Program</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">STAThread</span></span><span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span> args<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">using</span> <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> form <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Form</span>\n            <span class=\"token punctuation\">{</span>\n                FormBorderStyle <span class=\"token operator\">=</span> FormBorderStyle<span class=\"token punctuation\">.</span>Sizable<span class=\"token punctuation\">,</span>\n                Text <span class=\"token operator\">=</span> <span class=\"token string\">\"Hello WinForms\"</span><span class=\"token punctuation\">,</span>\n                ClientSize <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Size</span><span class=\"token punctuation\">(</span><span class=\"token number\">800</span><span class=\"token punctuation\">,</span> <span class=\"token number\">600</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> isRunning <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n            form<span class=\"token punctuation\">.</span>KeyUp <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>KeyData <span class=\"token operator\">==</span> Keys<span class=\"token punctuation\">.</span>Escape<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{</span>\n                    isRunning <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n            form<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>isRunning<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{</span>\n                Application<span class=\"token punctuation\">.</span><span class=\"token function\">DoEvents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>上記を実行すると下図のようなウインドウの生成と、Escキーを押すとプログラムが終了することが確認できました。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/45d7eb73d5c8997f0e41082cb90924cf/8efc2/2021-08-17-06-38-00.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAASUlEQVQoz+3LwQ2AMAgFUPbfr4kjNAFK+0F6NXEC5eDJd3/Ue2fmMcZ+LDMjwt3JzODAwnxj3UhVZ9WfP80iYlUE4Kyi1tpRdQGenJ9ErI1j0gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2021 08 17 06 38 00\"\n        title=\"2021 08 17 06 38 00\"\n        src=\"/static/45d7eb73d5c8997f0e41082cb90924cf/5a190/2021-08-17-06-38-00.png\"\n        srcset=\"/static/45d7eb73d5c8997f0e41082cb90924cf/772e8/2021-08-17-06-38-00.png 200w,\n/static/45d7eb73d5c8997f0e41082cb90924cf/e17e5/2021-08-17-06-38-00.png 400w,\n/static/45d7eb73d5c8997f0e41082cb90924cf/5a190/2021-08-17-06-38-00.png 800w,\n/static/45d7eb73d5c8997f0e41082cb90924cf/8efc2/2021-08-17-06-38-00.png 828w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","excerpt":"タイトル通りで、.NETアプリケーションでWindowsフォームを利用してウインドウを作成する方法をメモします。 手元の環境は下記のとおりです。 Windows 10 Visual Studio 2022 Preview 3 .NET 6 Preview 7での動作を確認しています。 プロジェクト作成 .csprojを作成します。テンプレートには下図のように.NETのConsole Applicationを指定します。  プロジェクト設定 下記のページを参考に設定します。 Microsoft…","fields":{"slug":"/2021/08/dotnet-windows-form/"},"frontmatter":{"date":"August 17, 2021","type":null,"tags":[".NET","C#"],"title":".NET アプリケーションでWindowsフォームを利用する","description":null,"eyecatch":null}}},"pageContext":{"id":"3dd7e47b-d336-53cc-9c9d-be71d2858886"}},"staticQueryHashes":["1480509143","3159585216"]}