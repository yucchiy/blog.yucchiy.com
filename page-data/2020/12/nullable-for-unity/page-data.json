{"componentChunkName":"component---src-templates-post-tsx","path":"/2020/12/nullable-for-unity/","result":{"data":{"markdownRemark":{"html":"<p><a href=\"https://unity3d.com/unity/whats-new/2020.2.0\">Unity 2020.2でC# 8が使えるようになりました</a>。これによって<a href=\"https://docs.microsoft.com/ja-jp/dotnet/csharp/nullable-references\">null許容参照型</a>が利用できるようになりました。</p>\n<p>今日においてnull参照は <a href=\"https://en.wikipedia.org/wiki/Null_pointer#History\">one billion-dollar mistake</a> と呼ばれるほど避けられるもので、最近の言語、例えばKotlinでは <a href=\"https://www.atmarkit.co.jp/ait/articles/1803/15/news012.html\">null安全</a> という仕組みを導入することでnull参照を<strong>コンパイル時に検出し、そのようなコードをコンパイルエラーとすること</strong>でこの問題を回避しています。</p>\n<p>C#のnull許容参照型も、この問題を解決するために導入されました。ただし、これまでのC#のコードは参照型へのnullの参照を許容しているので、いきなり参照型へのnull代入を完全に非許容とすると多くのコードが動作しなくなるので、警告の出力を行います。さらにこの機能は<strong>オプトイン方式で提供</strong>されています。つまり<strong>基本は無効で、設定を行うことではじめて有効</strong>になります。</p>\n<h2 id=\"null許容参照型を有効にする\" style=\"position:relative;\"><a href=\"#null%E8%A8%B1%E5%AE%B9%E5%8F%82%E7%85%A7%E5%9E%8B%E3%82%92%E6%9C%89%E5%8A%B9%E3%81%AB%E3%81%99%E3%82%8B\" aria-label=\"null許容参照型を有効にする permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>null許容参照型を有効にする</h2>\n<p>この機能は、ソースコードのこの部分では有効・無効、を切り替えることができます。これを null 許容コンテキストといいます。このコンテキストの切替方法は2つあります。</p>\n<ol>\n<li>コンパイルオプションで指定する</li>\n<li>プロジェクト全体での切り替える</li>\n<li>ソースコードの行単位での切り替える</li>\n</ol>\n<p>1.は、Unityでは「PlayerSettings > Player」にある「Additional Compiler Arguments」で<code>-nullable:enable</code>を追加します。</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACgUlEQVQoz6WTy27TQBSGDYRFVKmlBanqopSURLJKfRvbqS/j+DaeceLGJsVNUcWGLSsepJHgcVixapF4AdZELHgDkBv7IDttVcqSkT79Z86MPs2MNNzndyb3BnW3zOD53k6nw0uiwCuKwkuSyAuCwOu6zjPG+CRJeNMwrtZlXpElXpGXiRR5T5GlHe5q3MsC9xNJPDCw+0tWlEIUhEKW5UKSpAIhVNiWVWCMC03TCkEUC1GUbvNbFEXYF4Rvj9bXn9TCtmHjL4RQ8P2gCkICNnZAUVVAmtakjBDIigKypoOAdNiXVXghqzcpaQeA+saPjY3HzSnbg4FzTmkElmVdHsasSiNSRY5d0YFTMbdmcAunij23OiRhNQr8auh7i3EUguc485W1taeNEGN8kaYpRJQusoENYxJAGpEmR74LoWVCaBlLTAMibMHI9yB2nbouGbaBqPKcW1ldCj3Pu8jSFMIwXEwcC0i9wcHgGgdgaypgXfsbTQVLRWBrqJ6Xbl8DiqQ5t7axFPq+fzGZTGA4Gi1GgQ/5KIZXo7jJmgmLIIsIvKSkqa85iimcjJPydXoIrmnMuQetmyufD4dDIIQsQhJVR/lxlU9PmjzMsipirPIJqQJCmppQVpHrpKwklAF2BvOtzc2lsN/vnydJAo7jFL7vldPptJweH5d5npdHk0mZJEkZEVJGUVQyxu5yySgFz/O+P+t0lkKE0NfxeFyfsF6A09NTyPMcsiyDuh/Hcf2+DZTSf2CMgWmaP9vtdiNsbW9vvxUE4SPP82e7u7szRVFmqqrOdF2fSZI063a7s7pf0+v17nLW6/U+dDqd961Wa5XDGDe/pRZzHPfwP7hf/7s/SFs9okWF1NUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nullableをProjectSettingsから追加する\"\n        title=\"nullableをProjectSettingsから追加する\"\n        src=\"/static/764d9ef8df6bbee8b403ba3bfe3e44bb/5a190/enable-nullable-projectsettings.png\"\n        srcset=\"/static/764d9ef8df6bbee8b403ba3bfe3e44bb/772e8/enable-nullable-projectsettings.png 200w,\n/static/764d9ef8df6bbee8b403ba3bfe3e44bb/e17e5/enable-nullable-projectsettings.png 400w,\n/static/764d9ef8df6bbee8b403ba3bfe3e44bb/5a190/enable-nullable-projectsettings.png 800w,\n/static/764d9ef8df6bbee8b403ba3bfe3e44bb/b2cef/enable-nullable-projectsettings.png 847w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>nullableをProjectSettingsから追加する</p></figcaption>\n  </figure></p>\n<p>2.は、有効にしたいプロジェクトファイル( <code>*.csproj</code> )に <code>Nullable</code> を設定します。</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Project</span> <span class=\"token attr-name\">ToolsVersion</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>4.0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">DefaultTargets</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Build<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">xmlns</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://schemas.microsoft.com/developer/msbuild/2003<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PropertyGroup</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LangVersion</span><span class=\"token punctuation\">></span></span>latest<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>LangVersion</span><span class=\"token punctuation\">></span></span>\n\t  <span class=\"token comment\">&lt;!-- この行を追加 --></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Nullable</span><span class=\"token punctuation\">></span></span>enable<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Nullable</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>PropertyGroup</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token comment\">&lt;!-- ... --></span></code></pre></div>\n<p>3.は下記のようにソースコード中に <code>#nullable</code> ディレクティブを追記します。このディレクティブはコード中に設定を切り替えたいタイミングで記述できます。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token preprocessor property\">#<span class=\"token directive keyword\">nullable</span> enable</span>\n<span class=\"token comment\">// ここからnull許容コンテキストが有効</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Check</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 警告が出る</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> stringNotBeNull <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">string</span><span class=\"token punctuation\">?</span></span> stringMayBeNull <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\n    \n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">nullable</span> disable</span>\n    <span class=\"token comment\">// ここからnull許容コンテキストが無効</span>\n    <span class=\"token comment\">// そのため下記は警告が出ない</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> stringNotBeNull2 <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ただし手元の環境ではUnityのコンソールにおいて例外を吐くのは1.と3.で、2.はIDEでは有効でした(Riderでは警告を確認できました)。</p>\n<p>1.については(当然ですが)<strong>Unityプロジェクト全体で有効になります</strong>。特に<strong>unitypackageで取り込んだサードパーティーのライブラリなど</strong>もコンテキストが有効になってしまうのに注意が必要です。\n(ちなみに手元で検証したら、Package Managerで入るコードについてはその対象ではないようでした。)</p>\n<p>これは個人的にはasmdefレベル(csprojレベル)で、つまり2.をUnity公式にサポートしてくれるのが理想ではあるのですが、対応してくれると嬉しいのですが。来るといいですね。</p>\n<p>PlayerSettingsで設定する方法については、<a href=\"https://twitter.com/_enu\">@_enu</a>さんにご指摘いただき、2020/12/24に追記しました。ありがとうございました。</p>\n<blockquote class=\"twitter-tweet\"><p lang=\"ja\" dir=\"ltr\">PlayerSettingsでも有効にできそうですがいかがでしょうか？ <a href=\"https://t.co/AitRrwz34J\">pic.twitter.com/AitRrwz34J</a></p>&mdash; enu (@_enu) <a href=\"https://twitter.com/_enu/status/1341211069696512000?ref_src=twsrc%5Etfw\">December 22, 2020</a></blockquote> <script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n<h2 id=\"入門-null許容参照型\" style=\"position:relative;\"><a href=\"#%E5%85%A5%E9%96%80-null%E8%A8%B1%E5%AE%B9%E5%8F%82%E7%85%A7%E5%9E%8B\" aria-label=\"入門 null許容参照型 permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>入門 null許容参照型</h2>\n<p>実際にコードを見ながら動作を確かめてみます。この機能を有効にするとコンパイラでは次の規則が適用されます。</p>\n<ul>\n<li>参照型のすべての変数が、null非許容参照となります。この参照型にはnullを代入することができません。</li>\n<li>変数宣言のあとに <code>?</code> をつけるとその型はnull許容参照となります。</li>\n</ul>\n<p>実際に動作を見てみましょう。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token preprocessor property\">#<span class=\"token directive keyword\">nullable</span> enable</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Check</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span> \n    <span class=\"token comment\">// こちらはnull非許容参照型なので警告がでる</span>\n    <span class=\"token comment\">// warning CS8600: Converting null literal or possible null value to non-nullable type.</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> stringNotBeNull <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// こちらはnull許容参照型なので警告が出ない</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">string</span><span class=\"token punctuation\">?</span></span> stringMayBeNull <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>上記の規則上<code>stringNotBeNull</code> はnull非許容なので、この変数に <code>null</code> を代入すると警告がでます。一方で <code>stringMayBeNull</code> はnull許容なので <code>null</code> を代入しても警告が出ません。このように <code>?</code> の有無でその型がnullが代入可能かどうかを明示（アノテーション）することで、コンパイラはnullを代入しても良い型かどうかを認識することができ、その情報を元に警告を出しています。</p>\n<p>メソッドの引数と戻り値にも適用されます。まずは引数について見ていきましょう。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token comment\">// このメソッドの引数&lt;c>value&lt;/c>はnullが非許容</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">ValueCannotBeNull</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> <span class=\"token keyword\">value</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    _ <span class=\"token operator\">=</span> <span class=\"token keyword\">value</span><span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">ValueMayBeNull</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span><span class=\"token punctuation\">?</span></span> <span class=\"token keyword\">value</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// warning CS8625: Cannot convert null literal to non-nullable reference type.</span>\n    _ <span class=\"token operator\">=</span> <span class=\"token keyword\">value</span><span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code>ValueCannotBeNull</code> メソッドの引数 <code>value</code> はnull非許容なためnullが渡ってこないことが期待されます。そのためそのメソッド内の <code>value.Length</code> は安全に呼び出されるはずなので、例外は発生しません。一方で、 <code>ValueMayBeNull</code> はnull許容のためnullが渡ってくる可能性があるので、 <code>value.Length</code> はnull参照の可能性があります。そのためここでは警告が出ます。</p>\n<p>コンパイラによるチェックは、（コンテキストが有効であれば）このメソッドの呼び出し側でも行われます。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> stringNotBeNull <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">string</span><span class=\"token punctuation\">?</span></span> stringMayBeNull <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// null非許容なのにnullが渡されているので警告</span>\n<span class=\"token function\">ValueCannotBeNull</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// -> warning CS8625: Cannot convert null literal to non-nullable reference type.</span>\n\n<span class=\"token comment\">// nullでない値が渡されてるので警告が出ない</span>\n<span class=\"token function\">ValueCannotBeNull</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"non-null value\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// null非許容参照型の引数に対してnull許容参照型を渡してるので警告</span>\n<span class=\"token function\">ValueCannotBeNull</span><span class=\"token punctuation\">(</span>stringMayBeNull<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// -> warning CS8625: Cannot convert null literal to non-nullable reference type.</span>\n\n<span class=\"token comment\">// null非許容参照型だが、手前でnullが代入されているので警告がでる</span>\n<span class=\"token comment\">// (フロー解析とよばれる)</span>\n<span class=\"token function\">ValueCannotBeNull</span><span class=\"token punctuation\">(</span>stringNotBeNull<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// -> warning CS8604: Possible null reference argument for parameter 'value' in 'void CheckNullableMethod.ValueCannotBeNull(string value)'.</span>\n\n<span class=\"token comment\">// ただし同じ変数でも、非nullな値が代入されていれば警告が出ない</span>\n<span class=\"token comment\">// (フロー解析)</span>\nstringNotBeNull <span class=\"token operator\">=</span> <span class=\"token string\">\"non-null value\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">ValueCannotBeNull</span><span class=\"token punctuation\">(</span>stringNotBeNull<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>上記の通り概ね期待通りの動作をしていることが確認できました。１点興味深い点として、null許容参照型はフロー解析という仕組みによって、「コードのこの行で正しい値が代入されているか」をチェックしてくれます。具体的には、 <code>stringNotBeNull</code> 変数にははじめ <code>null</code> が代入されているので、最初の <code>ValueCannotBeNull(stringNotBeNull)</code> という呼び出しは警告がでます。ただし非nullな値を代入してから同じようにメソッドを呼び出すと、この時点では非nullなので警告は出なくなります。</p>\n<p>引数と同様、戻り値の型についてもチェックされます。 <code>ReturnValueMayBeNull</code> メソッドはnull許容な戻り値を返すため、直接 <code>returnMayBeNull.Length</code> を呼び出すと警告が出ます。ただしnullチェックを行うとその変数がnull出ないことを保証できるため、警告が出ません（フロー解析）。</p>\n<p>一方で <code>ReturnValueNotBeNull</code> メソッドの戻り値はnull非許容のためそのまま <code>returnNotBeNull.Length</code> を呼んでも警告は出ません。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">string</span><span class=\"token punctuation\">?</span></span> <span class=\"token function\">ReturnValueMayBeNull</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">\"non-null\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">string</span></span> <span class=\"token function\">ReturnValueNotBeNull</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Check</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 戻り値はnull許容</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> returnMayBeNull <span class=\"token operator\">=</span> <span class=\"token function\">ReturnValueMayBeNull</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// -> warning CS8600: Converting null literal or possible null value to non-nullable type.</span>\n    <span class=\"token comment\">// なのでnull参照の可能性があり警告</span>\n    _ <span class=\"token operator\">=</span> returnMayBeNull<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// -> warning CS8602: Dereference of a possibly null reference.</span>\n\n    <span class=\"token comment\">// ただしnull許容の場合はnullチェックをした上でアクセスすれば</span>\n    <span class=\"token comment\">// (nullではない保証がされるので)警告が出ない</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>returnMayBeNull <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> _ <span class=\"token operator\">=</span> returnMayBeNull<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 戻り値はnull非許容</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> returnNotBeNull <span class=\"token operator\">=</span> <span class=\"token function\">ReturnValueNotBeNull</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// 警告は出ない</span>\n    _ <span class=\"token operator\">=</span> returnNotBeNull<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ちなみにこのフロー解析は下記のように分岐があっても正しく動作します。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">CheckFlowAnalysisWithIf</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">bool</span></span> flag<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// フロー解析は、分岐があったとしても、問題なく動作する</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> str <span class=\"token operator\">=</span> flag <span class=\"token punctuation\">?</span> <span class=\"token string\">\"non-null\"</span> <span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// flagがfalseだとnullが入る可能性があるため、</span>\n    <span class=\"token comment\">// このメソッド呼び出しは警告が出る</span>\n    _ <span class=\"token operator\">=</span> str<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// -> warning CS8602: Dereference of a possibly null reference.</span>\n\n\t\t<span class=\"token comment\">// どの分岐でも非nullな値が入るために警告は出ない</span>\n\t\t<span class=\"token class-name\"><span class=\"token keyword\">string</span></span> notBeNull <span class=\"token operator\">=</span> flag <span class=\"token punctuation\">?</span> <span class=\"token string\">\"non-null\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"null\"</span><span class=\"token punctuation\">;</span>\n\t\t_ <span class=\"token operator\">=</span> mayBeNull<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">CheckFlowAnalysisWithSwitch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> <span class=\"token keyword\">value</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> mayBeNull<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">value</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n            mayBeNull <span class=\"token operator\">=</span> <span class=\"token string\">\"one\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n            mayBeNull <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// valueに1以外が入るとnullが入るため警告</span>\n    _ <span class=\"token operator\">=</span> mayBeNull<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// -> warning CS8602: Dereference of a possibly null reference.</span>\n\n    <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> notBeNull<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">value</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n            notBeNull <span class=\"token operator\">=</span> <span class=\"token string\">\"one\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n            notBeNull <span class=\"token operator\">=</span> <span class=\"token string\">\"default\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// すべてのケースで非nullのため警告は出ない</span>\n    _ <span class=\"token operator\">=</span> notBeNull<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"クラスのプロパティの初期化とnull許容参照型\" style=\"position:relative;\"><a href=\"#%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%81%AE%E5%88%9D%E6%9C%9F%E5%8C%96%E3%81%A8null%E8%A8%B1%E5%AE%B9%E5%8F%82%E7%85%A7%E5%9E%8B\" aria-label=\"クラスのプロパティの初期化とnull許容参照型 permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>クラスのプロパティの初期化とnull許容参照型</h3>\n<p>null許容コンテキストを有効にすると、クラスのプロパティはコンストラクタが呼び出された直後にはすべて非nullの値で初期化する必要があり、この規則に違反するとコンパイラは警告を出します。実際に例を見てみましょう。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CheckNullableClass</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// デフォルト値で初期化</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> InitializWithDefault\n        <span class=\"token operator\">=</span> <span class=\"token string\">\"default\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// コンストラクタ内で初期化</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> InitializeInConstructor<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// 未初期化</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> NotInitializedValue<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// -> warning CS8618: Non-nullable field 'NotInitializedValue' is uninitialized. Consider declaring the field as nullable.</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token function\">CheckNullableClassA</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> <span class=\"token keyword\">value</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        InitializeInConstructor <span class=\"token operator\">=</span> <span class=\"token keyword\">value</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>上記のクラスでは <code>NotInitializedValue</code> プロパティのみが警告されます。つまり、このクラスのインスタンスを生成した（newした）タイミングで <code>NotInitliazedValue</code> は未初期化なためです。（オブジェクト初期化子で初期化すれば初期化済みになるのではという意見もあると思いますが、呼び出し側に強制できないために、初期化済みの保証ができません。）</p>\n<h3 id=\"null許容演算子演算子\" style=\"position:relative;\"><a href=\"#null%E8%A8%B1%E5%AE%B9%E6%BC%94%E7%AE%97%E5%AD%90%E6%BC%94%E7%AE%97%E5%AD%90\" aria-label=\"null許容演算子演算子 permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>null許容演算子（!演算子）</h3>\n<p>ただし、null許容コンテキストを有効にしたいが、上記のようにコンストラクタ呼び出しまでに初期化できない、といったケースもあるかと思います。こういう場合にnull許容演算子が利用できます。 <code>NotInitializedValue</code> でnull許容演算子をデフォルト値として指定することで警告を回避しています。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CheckNullableClassFixed</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// デフォルト値で初期化</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> InitializWithDefault\n        <span class=\"token operator\">=</span> <span class=\"token string\">\"default\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// コンストラクタ内で初期化</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> InitializeInConstructor<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// 未初期化だがnull許容演算子を指定</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> NotInitializedValue <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token operator\">!</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token function\">CheckNullableClassFixed</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> <span class=\"token keyword\">value</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        InitializeInConstructor <span class=\"token operator\">=</span> <span class=\"token keyword\">value</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>裏を返すと、null許容演算子が指定されたプロパティは、利用者が責任を持って初期化する必要があります。そのためコードレビューなどではこの演算子を使われた場合は初期化をどのようするか議論すると良いのかもしれません。</p>\n<h2 id=\"unity利用での注意点について\" style=\"position:relative;\"><a href=\"#unity%E5%88%A9%E7%94%A8%E3%81%A7%E3%81%AE%E6%B3%A8%E6%84%8F%E7%82%B9%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\" aria-label=\"unity利用での注意点について permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Unity利用での注意点について</h2>\n<p>ここまでで、null許容参照型について紹介しました。ここで、Unityでこれを利用するにあたっていくつか気になった点を挙げます。</p>\n<ol>\n<li>null許容参照型のプロジェクト全体での有効設定（csprojに記載する方法）は、Unity上では有効にならなかった（コンソール上では表示されなかった）</li>\n<li>Unityのライフサイクルとnull許容の相性が悪い</li>\n<li>アノテーション属性は使えない</li>\n</ol>\n<p>1.に関しては、Unityのコンソール上では表示されませんでしたが、Riderでは警告が表示されることは確認できたので、利用しているIDE次第なところがあります。</p>\n<p>2.に関しては、例えばSerializeFieldです。下記のコードの場合、 <code>_hogeCache</code> プロパティは当然警告の対象となります。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HogeBehaviour</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">MonoBehaviour</span></span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">SerializeField</span></span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">HogeComponent</span> _hogeCache<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>対応はおそらく2通りで、null許容コンテキストを一時的にオフにするか、null許容演算子で初期化するかのどちらかになると思います。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token preprocessor property\">#<span class=\"token directive keyword\">nullable</span> enable</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HogeBehaviour</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">MonoBehaviour</span></span>\n<span class=\"token punctuation\">{</span>\n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">nullable</span> disable</span>\n    <span class=\"token comment\">// null許容コンテキストを一時的にオフにする</span>\n    <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">SerializeField</span></span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">HogeComponent</span> _hoge1Cache <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token operator\">!</span><span class=\"token punctuation\">;</span>\n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">nullable</span> enable</span>\n\n    <span class=\"token comment\">// null許容演算子を利用する</span>\n    <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">SerializeField</span></span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">HogeComponent</span> _hoge2Cache <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token operator\">!</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>また同じような話で、下記のように <code>Start</code> などで <code>GetComponent</code> することでプロパティを初期化したいケースもあります。この場合も上記と同じような対応を取る必要があるでしょう。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PiyoBehaviour</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">MonoBehaviour</span></span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        _piyoCache <span class=\"token operator\">=</span> <span class=\"token generic-method\"><span class=\"token function\">GetComponent</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>PiyoComponent<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">PiyoComponent</span> _piyoCache <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token operator\">!</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>3.はコンパイラーのフロー解析を補助するための<a href=\"https://ufcpp.net/study/csharp/resource/nullablereferencetype/?p=4#annotation-attributes\">アノテーション属性がある</a>のですが、Unityで利用可能なC#は.NET 4.x及び.NET Standard 2.0のため、これらは利用できませんでした。</p>\n<h2 id=\"おわりに\" style=\"position:relative;\"><a href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\" aria-label=\"おわりに permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>おわりに</h2>\n<p>C# 8のnull許容参照型について、Unity利用の観点でいくつかピックアップして紹介しました。\nnull許容参照型は、いわばコンパイラがnullチェックを手助けしてくれる機能なので、ぜひ積極的に使っていきたいところです。</p>\n<h2 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://docs.microsoft.com/ja-jp/dotnet/csharp/nullable-references\">null 許容参照型 | Microsoft Docs</a></li>\n<li><a href=\"https://ufcpp.net/study/csharp/resource/nullablereferencetype/\">null 許容参照型 - C# によるプログラミング入門 | ++C++; // 未確認飛行 C</a></li>\n<li><a href=\"https://www.meziantou.net/csharp-8-nullable-reference-types.htm\">C# 8: Nullable Reference Types - Meziantou's blog</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Null_pointer#History\">Null pointer - Wikipedia</a></li>\n</ul>","excerpt":"Unity 2020.2でC# 8が使えるようになりました。これによってnull許容参照型が利用できるようになりました。 今日においてnull参照は one billion-dollar mistake と呼ばれるほど避けられるもので、最近の言語、例えばKotlinでは null安全 という仕組みを導入することでnull参照をコンパイル時に検出し、そのようなコードをコンパイルエラーとすることでこの問題を回避しています。 C#のnull…","fields":{"slug":"/2020/12/nullable-for-unity/"},"frontmatter":{"date":"December 21, 2020","type":null,"tags":["Unity","C#"],"title":"Unity 2020.2で利用できるC#のnull許容参照型について理解する","description":null,"eyecatch":null}}},"pageContext":{"id":"5488e77e-cb6d-5137-8503-9c6db74e0c15"}},"staticQueryHashes":["1480509143","3159585216"]}