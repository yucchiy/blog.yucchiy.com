{"componentChunkName":"component---src-templates-post-tsx","path":"/2022/07/android-app-signing-aab-and-apk/","result":{"data":{"markdownRemark":{"html":"<p>Google Playのアプリは、2021年8月よりAAB（Android App Bundle）形式で提出することが必須となりました。</p>\n<p>AABの署名について調べると、（CLI経由で署名を行う場合は）jarsignerで署名すればOKという記事をみて、「あれ、APKの場合はapksignerで署名するのに、AABはjarsignerでいいんだっけ…?」という疑問がよぎり、AABの署名周りの理解が浅いな、と感じたので、メモ代わりにブログに残すことにします。</p>\n<h2 id=\"tldr\" style=\"position:relative;\"><a href=\"#tldr\" aria-label=\"tldr permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TL;DR</h2>\n<p>（この記事を書いた2022年7月）現在では、AABはアップロード鍵により署名します。実際に配布されるAPKの署名は、Playアプリ署名という仕組みで、事前に設定しておいたアプリ署名鍵によって署名されます。</p>\n<h2 id=\"apkのアプリ署名についてのおさらい\" style=\"position:relative;\"><a href=\"#apk%E3%81%AE%E3%82%A2%E3%83%97%E3%83%AA%E7%BD%B2%E5%90%8D%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%E3%81%AE%E3%81%8A%E3%81%95%E3%82%89%E3%81%84\" aria-label=\"apkのアプリ署名についてのおさらい permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>APKのアプリ署名についてのおさらい</h2>\n<p>AABの署名の前に、APKのアプリ署名について簡単にまとめておきます。</p>\n<p>Google Playにアプリをリリースする際には必ず、ディベロッパーの証明のために、APKに署名を行う必要があります。</p>\n<p><a href=\"https://source.android.com/security/apksigning?hl=ja\">アプリへの署名 | Android オープンソース プロジェクト | Android Open Source Project</a></p>\n<p>APKの署名には現在３つの方式が存在します。</p>\n<ul>\n<li>v1 スキーム: JAR署名</li>\n<li>v2 スキーム: Android 7.0で導入されたスキーム\n<ul>\n<li><a href=\"https://source.android.com/security/apksigning/v2?hl=ja\">APK 署名スキーム v2 | Android オープンソース プロジェクト | Android Open Source Project</a></li>\n</ul>\n</li>\n<li>v3 スキーム: Android 9.0で導入されたスキーム\n<ul>\n<li><a href=\"https://source.android.com/security/apksigning/v3?hl=ja\">APK 署名スキーム v3 | Android オープンソース プロジェクト | Android Open Source Project</a></li>\n</ul>\n</li>\n<li>v4 スキーム: Android11.0で導入されたスキーム\n<ul>\n<li><a href=\"https://source.android.com/security/apksigning/v4?hl=ja\">APK 署名スキーム v4 | Android オープンソース プロジェクト | Android Open Source Project</a></li>\n</ul>\n</li>\n</ul>\n<p>v1 スキームは、<a href=\"https://docs.oracle.com/javase/jp/1.5.0/tooldocs/windows/jarsigner.html\">署名付きJAR</a>という方式に基づいています。つまりこの署名は、Android独自のものではなく、Javaエコシステムの署名を利用していると言えます。この署名を行うには <code>jarsigner</code> というツールを用いて下記のように署名します。</p>\n<div class=\"gatsby-highlight\" data-language=\"plaintext\"><pre class=\"language-plaintext\"><code class=\"language-plaintext\">$ jarsigner -verbose \\\n    -sigalg SHA256withRSA \\\n    -digestalg SHA-256 \\\n    -keystore test.keystore \\\n    test.aab upload</code></pre></div>\n<p>一方で、v2スキーム以降の署名はAndroid独自の署名形式です。ツールも <code>apksigner</code> というツールを用いて下記のように署名します。</p>\n<div class=\"gatsby-highlight\" data-language=\"plaintext\"><pre class=\"language-plaintext\"><code class=\"language-plaintext\">$ apksigner sign --ks test.keystore test.apk</code></pre></div>\n<h2 id=\"playアプリ署名\" style=\"position:relative;\"><a href=\"#play%E3%82%A2%E3%83%97%E3%83%AA%E7%BD%B2%E5%90%8D\" aria-label=\"playアプリ署名 permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Playアプリ署名</h2>\n<p>Google Playでは、事前に登録しておいたアプリ署名鍵で、ディベロッパーに変わってアプリに署名する仕組みが用意されています。これを「Playアプリ署名」と言います。</p>\n<p><a href=\"https://support.google.com/googleplay/android-developer/answer/9842756?hl=ja\">Play アプリ署名を使用する - Play Console ヘルプ</a></p>\n<p><a href=\"https://developer.android.com/studio/publish/app-signing?hl=ja#enroll\">アプリへの署名 | Android デベロッパー | Android Developers</a></p>\n<p>Playアプリ署名を用いた、アプリの署名フローは下記のとおりです。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/15e02b94500c4ba9cef37959809d16db/e4ba2/9F11A47706E14FEE42C66A543CB0B018.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.999999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/UlEQVQY0yWPQUsCYRiE95f2d6JTh6hDeAmhg4coqYMIXiRECoTYtTRxczdXt1Zz1cD9vvf9nthtTsPwzMB4agxYizGGfJsThGPSWcR+taoy5xwqBlWLNZYo+eRt+s5yHrNefSGiiIgWRVHysfcUBNz2e+ySjGb2zEl2x8ViwnEYIfkOu87pPg7o9V+Q7S9nixbnP22umxMeWiHsd2zSTIPXIWmaxl4jWXDk+zijtL4HnC7vuVl+UA8jzKGg1GU94KoxAhy1eYda1qHdndHtzQDFWtHyjbU29pLNhv40rIpYRYyAOhCp7jqn+MOQ0TjGqVSMlgyuGtOSLc2/4j+jYycjYKSorAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"9F11A47706E14FEE42C66A543CB0B018\"\n        title=\"9F11A47706E14FEE42C66A543CB0B018\"\n        src=\"/static/15e02b94500c4ba9cef37959809d16db/5a190/9F11A47706E14FEE42C66A543CB0B018.png\"\n        srcset=\"/static/15e02b94500c4ba9cef37959809d16db/772e8/9F11A47706E14FEE42C66A543CB0B018.png 200w,\n/static/15e02b94500c4ba9cef37959809d16db/e17e5/9F11A47706E14FEE42C66A543CB0B018.png 400w,\n/static/15e02b94500c4ba9cef37959809d16db/5a190/9F11A47706E14FEE42C66A543CB0B018.png 800w,\n/static/15e02b94500c4ba9cef37959809d16db/c1b63/9F11A47706E14FEE42C66A543CB0B018.png 1200w,\n/static/15e02b94500c4ba9cef37959809d16db/e4ba2/9F11A47706E14FEE42C66A543CB0B018.png 1468w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Playアプリ署名を用いることで、ディベロッパーに変わってGoogleの安全なインフラ上でアプリの署名鍵が管理されます。アプリの署名鍵をなくすと、アプリのアップデートが行えないとった問題が解消されます。</p>\n<p>ちなみにAABを配信する場合は、先程紹介した自分自身でAPK署名を行う手段はないため、<strong>必ずPlayアプリ署名を設定を行う必要があります</strong>。</p>\n<p>さらに、2021年8月以降に新規リリースしたアプリはAABでのアプリ提出が必須のため、<strong>現状では実質Playアプリ署名の利用が必須となります。</strong>（2021年8月までにリリースしたアプリはAPKでの提出が可能なため、自身で署名したAPKによるリリースが可能です。）</p>\n<p>Playアプリ署名を利用してアプリに署名を行うには、下記の設定を行います。</p>\n<ol>\n<li>アップロード鍵とキーストアを作成する</li>\n<li>Playアプリ署名の設定を行う</li>\n<li>アップロード鍵でAAB（またはAPK）に署名して、Play Consoleでそのアプリを提出する</li>\n</ol>\n<h3 id=\"アップロード鍵の作成\" style=\"position:relative;\"><a href=\"#%E3%82%A2%E3%83%83%E3%83%97%E3%83%AD%E3%83%BC%E3%83%89%E9%8D%B5%E3%81%AE%E4%BD%9C%E6%88%90\" aria-label=\"アップロード鍵の作成 permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>アップロード鍵の作成</h3>\n<p>アップロード鍵を作成するのに<a href=\"https://developer.android.com/studio/publish/app-signing#generate-key\"> Android Studioによる鍵の作成方法が公式ドキュメントで紹介されています</a>が、 <code>keytool</code> での作成方法を紹介します。キー作成の方法は下記のとおりです。</p>\n<div class=\"gatsby-highlight\" data-language=\"plaintext\"><pre class=\"language-plaintext\"><code class=\"language-plaintext\">$ keytool -genkey -v \\\n    -keystore test.keystore \\\n    -storepass himitsu-no-storepass \\\n    -alias upload \\\n    -keypass himitsu-no-keypass \\\n    -keyalg RSA\n    -length 2048 \\\n    -validity 36500</code></pre></div>\n<p>鍵が格納されたストアファイルを <code>test.keystore</code> に、鍵名を <code>upload</code> で作成しています。鍵の有効期限は100年としています。アルゴリズムはRSA、鍵長さは2048です。 <code>-keypass</code> および <code>-keypass</code> は、この鍵で署名するさいにそれぞれ必要です。適切に管理します。</p>\n<p>上記コマンドを実行後に、下記のような内容を確認されますが、適当なものを入力します。入力が完了するとキーストアが作成されます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 753px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2898ceabd5c0d7755effec8ec1598df0/17a7a/E1AC8235E733AD2732F0FDE3B3B7BB56.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABYElEQVQoz42O246iQBRFaaQFaRQQtKgbIGBsIZI26Yn//2VrQiX2OJmXeVjZJ/ukVh3ver0yTRN937uc55lhGEjTlCRJiKKIIAj+YrVa/dM9e28cRyep65qqqpBSYq1Fa01RFMRxjO/7Pw+esuf8ytJ79687j8eDvh+cTCmF0cZJsyz7kf0v3m2+8f3rm1N3QlQCqaQTCyGwtWUdrp10ucBf+S8XvczBnyu96XPiPt/p2x6rapTQmMogjwpRCrTQ5LucMAjZrDdE7xHR+8YRBpHrnyw7b2g/mccvWt1RFZpjLtHHmjIVLoutQB1qDqnEiNbl0lWFIQ52rL2Y8O2D0E8I/Q88VdU0tqNrz7TNQFv3GN1iVIM1J7dr7IBVHa0907UXLucbtekpc8k+q9inAlEa0qTEk0eDlg2n5szlPLJ8kKcH9umBIhduXjLblk6Q744c9tpJ4jBlvUoIF4Kt4zcuG8HkIRsJTwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"E1AC8235E733AD2732F0FDE3B3B7BB56\"\n        title=\"E1AC8235E733AD2732F0FDE3B3B7BB56\"\n        src=\"/static/2898ceabd5c0d7755effec8ec1598df0/17a7a/E1AC8235E733AD2732F0FDE3B3B7BB56.png\"\n        srcset=\"/static/2898ceabd5c0d7755effec8ec1598df0/772e8/E1AC8235E733AD2732F0FDE3B3B7BB56.png 200w,\n/static/2898ceabd5c0d7755effec8ec1598df0/e17e5/E1AC8235E733AD2732F0FDE3B3B7BB56.png 400w,\n/static/2898ceabd5c0d7755effec8ec1598df0/17a7a/E1AC8235E733AD2732F0FDE3B3B7BB56.png 753w\"\n        sizes=\"(max-width: 753px) 100vw, 753px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>キーストアに保存されている鍵を確認するのも <code>keystore</code> で行えます。</p>\n<div class=\"gatsby-highlight\" data-language=\"plaintext\"><pre class=\"language-plaintext\"><code class=\"language-plaintext\">$ keytool -list \\\n    -keystore test.keystore \\\n    -storepass himitsu-no-storepass\nKeystore type: jks\nKeystore provider: SUN\n\nYour keystore contains 1 entry\n\nupload, Jul 21, 2022, PrivateKeyEntry, \nCertificate fingerprint (SHA1): 89:7F:BE:D8:B0:BE:27:C0:D2:86:32:E1:87:0F:A3:E8:28:C5:08:21</code></pre></div>\n<p>行最後の <code>upload, Jul 21, 2022, PrivateKeyEntry</code> というところが先ほど作った <code>upload</code> 鍵のエントリになります。</p>\n<p>先述しましたが、aabをCLIで作成したアップロード鍵で署名するには、下記のように <code>jarsigner</code> で行なえます。</p>\n<div class=\"gatsby-highlight\" data-language=\"plaintext\"><pre class=\"language-plaintext\"><code class=\"language-plaintext\">$ jarsigner -verbose \\\n    -sigalg SHA256withRSA \\\n    -digestalg SHA-256 \\\n    -keystore test.keystore \\\n    -storepass himitsu-no-storepass \\\n    -keypass himitsu-no-keypass \\\n    test.aab \\\n    upload</code></pre></div>\n<p><code>test.aab</code> が署名したいAAB、 <code>upload</code> が先ほど作成した鍵のエイリアスです。</p>\n<p>署名の確認には <code>keytoole</code> を利用します。</p>\n<div class=\"gatsby-highlight\" data-language=\"plaintext\"><pre class=\"language-plaintext\"><code class=\"language-plaintext\">$ keytool -printcert -jarfile test.aab\nSigner #1:\n\nSignature:\n\nOwner: CN=Unknown, OU=Unknown, O=Unknown, L=Unknown, ST=Unknown, C=Unknown\nIssuer: CN=Unknown, OU=Unknown, O=Unknown, L=Unknown, ST=Unknown, C=Unknown\nSerial number: 59381047\nValid from: Fri Jul 22 02:28:04 JST 2022 until: Sat Jun 18 02:28:04 JST 2032\nCertificate fingerprints:\n\t MD5:  08:6D:1D:D9:04:C9:06:0C:77:B8:4D:83:BA:73:90:48\n\t SHA1: B6:96:03:B2:D3:49:A2:DC:A0:EB:94:4E:62:77:66:97:76:48:F2:22\n\t SHA256: 5A:D1:4B:D0:9C:24:34:14:79:F9:FE:FF:9D:9E:92:BB:FE:E3:FF:77:DC:CC:38:05:0D:8C:D1:98:90:49:7E:D0\nSignature algorithm name: SHA256withRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions: \n\n#1: ObjectId: 2.5.29.14 Criticality=false\nSubjectKeyIdentifier [\nKeyIdentifier [\n0000: C1 6A D4 5D EE 79 2A E3   8E 5A 06 D7 7F 89 71 3F  .j.].y*..Z....q?\n0010: 48 66 E8 B5                                        Hf..\n]\n]</code></pre></div>\n<h3 id=\"playアプリ署名の設定\" style=\"position:relative;\"><a href=\"#play%E3%82%A2%E3%83%97%E3%83%AA%E7%BD%B2%E5%90%8D%E3%81%AE%E8%A8%AD%E5%AE%9A\" aria-label=\"playアプリ署名の設定 permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Playアプリ署名の設定</h3>\n<p>次に、Playアプリ署名の設定です。</p>\n<p>こちらの署名にも鍵が必要です。Playアプリ署名で利用する鍵は、先ほどのアップロード鍵とは別のものを利用します。</p>\n<p>鍵の作成方法には大きく分けて下記の２つの方法があります。</p>\n<ol>\n<li>アプリ署名鍵をGoogle Play側で作成する</li>\n<li>既存のキーストアから鍵をエクスポートする</li>\n</ol>\n<p>特に理由がない限りは 1. の方法で鍵を作成するのが手軽かつ鍵の管理の手間が省けます。また、特に設定しない限り自動的に1. の方法でアプリが署名されるようです。</p>\n<ol start=\"2\">\n<li>は、「既存のアプリを自身でアプリ署名しているが、今使っている鍵を使ってPlayアプリ署名に切り替えたい」とか「Google Play以外のストアにもアプリを公開していて、そちらのAPK署名に同じ鍵を使いたい」といった場合でしょうか。</li>\n</ol>\n<h3 id=\"aabのアップロード\" style=\"position:relative;\"><a href=\"#aab%E3%81%AE%E3%82%A2%E3%83%83%E3%83%97%E3%83%AD%E3%83%BC%E3%83%89\" aria-label=\"aabのアップロード permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AABのアップロード</h3>\n<p>署名したAABをストアにアップロードします。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/aa0eb13fff3d44bca19c3e58ddff46ff/8ecb0/8E21D4590EC331CD6B1FB6A527C9F3B5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAZklEQVQY052PQQqEQAwE5/+v9LQQhRWNChqTkvEgMiiKBZ1TqE6SqiIiiNSM40QmIj4nUVAuQOABa/BY5u6kPNzPgrLA0WGi6wdsWQ7pFfuFd6LTGs1fqX4tZvZeeJfM6jBbvHp5A/WbjBwGl8cxAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"8E21D4590EC331CD6B1FB6A527C9F3B5\"\n        title=\"8E21D4590EC331CD6B1FB6A527C9F3B5\"\n        src=\"/static/aa0eb13fff3d44bca19c3e58ddff46ff/5a190/8E21D4590EC331CD6B1FB6A527C9F3B5.png\"\n        srcset=\"/static/aa0eb13fff3d44bca19c3e58ddff46ff/772e8/8E21D4590EC331CD6B1FB6A527C9F3B5.png 200w,\n/static/aa0eb13fff3d44bca19c3e58ddff46ff/e17e5/8E21D4590EC331CD6B1FB6A527C9F3B5.png 400w,\n/static/aa0eb13fff3d44bca19c3e58ddff46ff/5a190/8E21D4590EC331CD6B1FB6A527C9F3B5.png 800w,\n/static/aa0eb13fff3d44bca19c3e58ddff46ff/8ecb0/8E21D4590EC331CD6B1FB6A527C9F3B5.png 989w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>初回に署名したアップロード鍵が、次以降のアップロード鍵として認識されるようなので、このアップロード鍵を無くさないようにします。</p>\n<h2 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://source.android.com/security/apksigning?hl=ja\">アプリへの署名 | Android オープンソース プロジェクト | Android Open Source Project</a></li>\n<li><a href=\"https://docs.oracle.com/javase/8/docs/technotes/guides/jar/jar.html#Signed_JAR_File\">JAR File Specification</a></li>\n<li><a href=\"https://source.android.com/security/apksigning/v2?hl=ja\">APK 署名スキーム v2 | Android オープンソース プロジェクト | Android Open Source Project</a></li>\n<li><a href=\"https://source.android.com/security/apksigning/v3?hl=ja\">APK 署名スキーム v3 | Android オープンソース プロジェクト | Android Open Source Project</a></li>\n<li><a href=\"https://support.google.com/googleplay/android-developer/answer/9842756?hl=ja\">Play アプリ署名を使用する - Play Console ヘルプ</a></li>\n<li><a href=\"https://developer.android.com/studio/publish/app-signing?hl=ja#enroll\">アプリへの署名 | Android デベロッパー | Android Developers</a></li>\n</ul>","excerpt":"Google Playのアプリは、2021年8月よりAAB（Android App Bundle）形式で提出することが必須となりました。 AABの署名について調べると、（CLI経由で署名を行う場合は）jarsignerで署名すればOKという記事をみて、「あれ、APKの場合はapksignerで署名するのに、AABはjarsignerでいいんだっけ…?」という疑問がよぎり、AABの署名周りの理解が浅いな、と感じたので、メモ代わりにブログに残すことにします。 TL;DR （この記事を書いた202…","fields":{"slug":"/2022/07/android-app-signing-aab-and-apk/"},"frontmatter":{"date":"July 21, 2022","type":"tech","tags":["Android","署名"],"title":"AndroidのAAB（Android App Bundle）の署名について","description":"AndroidのAABの署名、アップロード鍵の署名やPlayアプリ署名などについてまとめます。","eyecatch":null}}},"pageContext":{"id":"48696f89-aa0d-50c6-ba71-a02c83d7803e"}},"staticQueryHashes":["1480509143","3159585216"]}