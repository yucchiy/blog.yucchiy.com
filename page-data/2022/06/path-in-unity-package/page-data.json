{"componentChunkName":"component---src-templates-post-tsx","path":"/2022/06/path-in-unity-package/","result":{"data":{"markdownRemark":{"html":"<p>Unityでパッケージ開発を行っている際に、「パッケージ内で管理しているアセットをロードしたい、コピーしてきたい」と思ったとき、そもそもパッケージ内のアセットのパスの扱いってどうなっているんだっけ…？ってのが分からなかったので、調べたついでにメモとして残しておきます。</p>\n<h2 id=\"パッケージのアセットデータベースのパス\" style=\"position:relative;\"><a href=\"#%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E3%82%A2%E3%82%BB%E3%83%83%E3%83%88%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AE%E3%83%91%E3%82%B9\" aria-label=\"パッケージのアセットデータベースのパス permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>パッケージの（アセットデータベースの）パス</h2>\n<p>プロジェクト内のアセットは、下記のパススキームで参照できます。</p>\n<div class=\"gatsby-highlight\" data-language=\"plaintext\"><pre class=\"language-plaintext\"><code class=\"language-plaintext\">Assets/PATH/TO/ASSET</code></pre></div>\n<p>一方で、たとえば <code>com.yucchiy.benri-tool</code> というパッケージ名の、パッケージ内のアセットは、下記のパススキームで参照します。</p>\n<div class=\"gatsby-highlight\" data-language=\"plaintext\"><pre class=\"language-plaintext\"><code class=\"language-plaintext\">Packages/com.yucchiy.benri-tool/PATH/TO/ASSET</code></pre></div>\n<p>ちなみにパッケージ名は、 <code>package.json</code> の <code>name</code> を指します。下図の <code>package.json</code> の場合、 <code>com.yucchiy.benri-tool</code> がパッケージ名です。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 511px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a42b5d301b9ffef8f17652ba5787b133/92e00/C4F67F2500A152DE16762C79A91B5775.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABsUlEQVQoz52SW27bMBBFtQ6blEjxTUmWHcl1jNgJ2hTNR9v9L+cUou0gSNqi6MfF3BE4hzMjVsMmst/PzPPMbrcj50xKiZQyMSVivPiSX/0Sb3o9e82rEC33hwOHw7FAF2DwgRAiKaZLHiLeB3LKJd4uuIG895c8d1RKabwLpNjivSPGSAieGC+FC9CHUIqKv8a+6+m6rpxZ6hbfDxuqupa0bYtWa5RuydMR14041XCXHIM33EVH7wxjMGTbMgZLqxpWqxXr9RohRImLqrqusdYipURbz+7phbunF/r9kd5bTmPHYUgkZ+icIZiWZA3etCy171WApgBFAW7P35g+fycOI3O0PG47pi4W0Da6Ai3ytgCWRj4A7SswsD19Zfryk2F/z/HhzHazYcqB7CwrIVkLgZCy6AZ8C710aCy1lChjGU/PTM8/2MwPpLxFKYXVCtdqjFZo1dD8ZtQPHQpZoxtNIyR+2DF8OpXFLz9k7iJjcOy7wJT9pas/AbXWWOuwZk2rdIEKKcoK5HU0cR3rra+v8b2q5aEuIz+ej+U9LQVN0/y3qttC29aUD/Vf9vMv+gVk7VZn4TEn9AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"C4F67F2500A152DE16762C79A91B5775\"\n        title=\"C4F67F2500A152DE16762C79A91B5775\"\n        src=\"/static/a42b5d301b9ffef8f17652ba5787b133/92e00/C4F67F2500A152DE16762C79A91B5775.png\"\n        srcset=\"/static/a42b5d301b9ffef8f17652ba5787b133/772e8/C4F67F2500A152DE16762C79A91B5775.png 200w,\n/static/a42b5d301b9ffef8f17652ba5787b133/e17e5/C4F67F2500A152DE16762C79A91B5775.png 400w,\n/static/a42b5d301b9ffef8f17652ba5787b133/92e00/C4F67F2500A152DE16762C79A91B5775.png 511w\"\n        sizes=\"(max-width: 511px) 100vw, 511px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>パッケージ内のアセットのロードに話を戻します。具体的に、下図の <code>TestPrefab.prefab</code> があるとして、</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 593px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a5a3b58bcd6a52bde7573562b91da7e0/0b5b1/90E878DED317F471781CF4A762C3F5FE.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABnklEQVQoz6WSSY/TMBzF82XQMEnUbM1mZ5lsztZ02jR0FZVKe6ECLtz56g/Z6kSF4QDD4adnS/bTe39bsiwLmqYhyUsUdQcSJVBUFbIsQ5aVGzLeP8p4J09GHhQND4r+Cmm5XKIoCmRZiqc4QkApPM9DGAagxBdEYYDkKUKaREKTOERAPFDfBSU3bmvpeDxiNpsJyqqC7/uYTqdI8wrXr98xe/6AphuQlXPk1bPQlHUgMYMfFvCjX5F2ux3qukZVVYiiCK7rYWqZCPIeHz//QL35BjZ8gc1OcNinEbc8w61eI10uF8zncwzDgL7vkSQJCKUwDR2q8ghtokLXVFjGBOY9+p+RrtcrNpsNDocDttutMOdpwzCEaVmivmX9PdJ+vxfz67pOPA6vTSlFHMcwDAP8F/wLEk/GZ9i2LfI8h+M4CILg7Yan00nUXK1WYIzBdd3/Mzyfz1gsFqIuN7Nt+02VTdMUjJX5HLmmaYosy8QsdV0Xpr/zcvl+PyZcr9ciXdM0goIx+I6NctijXfRom3r8p/f6cp4H4QEIIaLZT5Ovmx0sOUWXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"90E878DED317F471781CF4A762C3F5FE\"\n        title=\"90E878DED317F471781CF4A762C3F5FE\"\n        src=\"/static/a5a3b58bcd6a52bde7573562b91da7e0/0b5b1/90E878DED317F471781CF4A762C3F5FE.png\"\n        srcset=\"/static/a5a3b58bcd6a52bde7573562b91da7e0/772e8/90E878DED317F471781CF4A762C3F5FE.png 200w,\n/static/a5a3b58bcd6a52bde7573562b91da7e0/e17e5/90E878DED317F471781CF4A762C3F5FE.png 400w,\n/static/a5a3b58bcd6a52bde7573562b91da7e0/0b5b1/90E878DED317F471781CF4A762C3F5FE.png 593w\"\n        sizes=\"(max-width: 593px) 100vw, 593px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>このプレハブを<strong>アセットデータベース経由で</strong>ロードしてインスタンス化するには、下記のコードで実現できます。</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token class-name\"><span class=\"token keyword\">var</span></span> prefab <span class=\"token operator\">=</span> AssetDatabase<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">LoadAssetAtPath</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>GameObject<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"Packages/com.yucchiy.benri-tool/TestPrefab.prefab\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">var</span></span> obj <span class=\"token operator\">=</span> GameObject<span class=\"token punctuation\">.</span><span class=\"token function\">Instantiate</span><span class=\"token punctuation\">(</span>prefab<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>また、記事冒頭の要件である、パッケージ内のアセットをプロジェクト配下へコピーするには、アセットデータベース経由では、下記コードで実現できます。</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token comment\">// 上記プレハブをプロジェクトのAssetsフォルダ直下にコピー！</span>\nAssetDatabase<span class=\"token punctuation\">.</span><span class=\"token function\">CopyAsset</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"Packages/com.yucchiy.benri-tool/TestPrefab.prefab\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Assets/TestPrefab.prefab\"</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>アセットデータベース経由ということは、つまりパッケージ内のアセットに <code>.meta</code> が作成されていて、かつ、コピー先のフォルダも、 <code>Assets</code> 配下など、アセットデータベースによって管理されている必要があります。</p>\n<p>大抵のケースは事足りるのですが、稀にアセットデータベース管理外のファイルをコピーなどしたい場合があるかもしれません。そういうときは、パッケージ内のファイルを（そのOSの）フルパスで参照し、 <code>System.IO</code> に提供されるAPIでファイル操作すると良いでしょう。</p>\n<p>パッケージ内のファイルのフルパスを取得するには <code>Path.GetFullPath</code> を利用します。</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token comment\">// 末尾にチルダ(~)をつけたファイル・フォルダは</span>\n<span class=\"token comment\">// アセットデータベースの管理から外れる（.metaがつかない）</span>\n<span class=\"token class-name\"><span class=\"token keyword\">string</span></span> path <span class=\"token operator\">=</span> Path<span class=\"token punctuation\">.</span><span class=\"token function\">GetFullPath</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Packages/com.yucchiy.benri-tool/benri.txt~\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// プロジェクト配下にコピー</span>\nFile<span class=\"token punctuation\">.</span><span class=\"token function\">Copy</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> Path<span class=\"token punctuation\">.</span><span class=\"token function\">Combine</span><span class=\"token punctuation\">(</span>Application<span class=\"token punctuation\">.</span>dataPath<span class=\"token punctuation\">,</span> <span class=\"token string\">\"..\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"benri.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"余談-resourcesフォルダの扱い\" style=\"position:relative;\"><a href=\"#%E4%BD%99%E8%AB%87-resources%E3%83%95%E3%82%A9%E3%83%AB%E3%83%80%E3%81%AE%E6%89%B1%E3%81%84\" aria-label=\"余談 resourcesフォルダの扱い permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>余談: Resourcesフォルダの扱い</h3>\n<p>ここまで調べてみて<code>Packages/{パッケージ名}</code> がプレフィックスになり、それ以外は通常のUnityプロジェクトにおけるパスの扱いと変わらないのかな？と思い、たとえば <code>Resources</code> の扱いはどうなるんだろう？と気になりました。</p>\n<p>そこで、<code>Packages/{パッケージ名}</code> 以下に <code>Resources</code> フォルダを作成し、 <code>Resources.Load</code> 経由でアセットをロードしてみました。</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token class-name\"><span class=\"token keyword\">var</span></span> prefabInResources <span class=\"token operator\">=</span> Resources<span class=\"token punctuation\">.</span><span class=\"token function\">Load</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"Packages/com.yucchiy.benri-tool/Resources/TestPrefabInResources.prefab\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">var</span></span> obj2 <span class=\"token operator\">=</span> GameObject<span class=\"token punctuation\">.</span><span class=\"token function\">Instantiate</span><span class=\"token punctuation\">(</span>prefabInResources<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>結果として、正しくプレハブをロードできない結果となりました。ちなみにパッケージ下に <code>Assets/Resources</code> を掘って、その中にプレハブを置いてロードしてもダメでした。どうやら <code>Resources</code> フォルダの展開は<strong>プロジェクト内だけ</strong>のようです。（迂闊に展開されちゃうと、パッケージ内に <code>Resources</code> フォルダがありその中にデータがあると起動時間等が懸念されるのでこれはこれでよいのですが）</p>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>Unityのパッケージ内のアセットのパスの扱いと、パッケージ内のアセットをプロジェクトにコピーする方法、余談ではありますがパッケージにおける <code>Resources</code> フォルダの扱いについてまとめました。</p>\n<h2 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://docs.unity3d.com/ja/2020.3/Manual/upm-assets.html\">パッケージアセットへのアクセス - Unity マニュアル</a></li>\n</ul>","excerpt":"Unityでパッケージ開発を行っている際に、「パッケージ内で管理しているアセットをロードしたい、コピーしてきたい」と思ったとき、そもそもパッケージ内のアセットのパスの扱いってどうなっているんだっけ…？ってのが分からなかったので、調べたついでにメモとして残しておきます。 パッケージの（アセットデータベースの）パス プロジェクト内のアセットは、下記のパススキームで参照できます。 一方で、たとえば com.yucchiy.benri-tool…","fields":{"slug":"/2022/06/path-in-unity-package/"},"frontmatter":{"date":"June 18, 2022","type":"tech","tags":["Unity","パッケージ開発"],"title":"Unity パッケージにおけるパスの扱いについて","description":"Unityでパッケージ開発をする際のパスの扱い方や、パッケージ内のアセットにアクセスする方法についてまとめます。","eyecatch":null}}},"pageContext":{"id":"83e8ee68-fc12-5e82-b7d4-3945392606f8"}},"staticQueryHashes":["1480509143","3159585216"]}