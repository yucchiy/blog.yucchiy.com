<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.16.0"/><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="alternate" type="application/rss+xml" title="Yucchiy&#x27;s Note" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=ced7ce5d16d58390b9715f99f691b449" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=ced7ce5d16d58390b9715f99f691b449"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=ced7ce5d16d58390b9715f99f691b449"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=ced7ce5d16d58390b9715f99f691b449"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=ced7ce5d16d58390b9715f99f691b449"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=ced7ce5d16d58390b9715f99f691b449"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=ced7ce5d16d58390b9715f99f691b449"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=ced7ce5d16d58390b9715f99f691b449"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=ced7ce5d16d58390b9715f99f691b449"/><style data-href="/styles.efa6d53b05e0f8a1a318.css" data-identity="gatsby-global-css">/*
! tailwindcss v3.1.2 | MIT License | https://tailwindcss.com
*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}html{-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::-webkit-backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}.prose{color:var(--tw-prose-body);max-width:65ch}.prose :where([class~=lead]):not(:where([class~=not-prose] *)){color:var(--tw-prose-lead);font-size:1.25em;line-height:1.6;margin-bottom:1.2em;margin-top:1.2em}.prose :where(a):not(:where([class~=not-prose] *)){color:#dc4e47;font-weight:500;text-decoration:underline}.prose :where(strong):not(:where([class~=not-prose] *)){color:var(--tw-prose-bold);font-weight:600}.prose :where(ol):not(:where([class~=not-prose] *)){list-style-type:decimal;padding-left:1.625em}.prose :where(ol[type=A]):not(:where([class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a]):not(:where([class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=A s]):not(:where([class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a s]):not(:where([class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=I]):not(:where([class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i]):not(:where([class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type=I s]):not(:where([class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i s]):not(:where([class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type="1"]):not(:where([class~=not-prose] *)){list-style-type:decimal}.prose :where(ul):not(:where([class~=not-prose] *)){list-style-type:disc;padding-left:1.625em}.prose :where(ol>li):not(:where([class~=not-prose] *))::marker{color:var(--tw-prose-counters);font-weight:400}.prose :where(ul>li):not(:where([class~=not-prose] *))::marker{color:var(--tw-prose-bullets)}.prose :where(hr):not(:where([class~=not-prose] *)){border-color:var(--tw-prose-hr);border-top-width:1px;margin-bottom:3em;margin-top:3em}.prose :where(blockquote):not(:where([class~=not-prose] *)){border-left-color:var(--tw-prose-quote-borders);border-left-width:.25rem;color:var(--tw-prose-quotes);font-style:italic;font-weight:500;margin-bottom:1.6em;margin-top:1.6em;padding-left:1em;quotes:"\201C""\201D""\2018""\2019"}.prose :where(blockquote p:first-of-type):not(:where([class~=not-prose] *)):before{content:open-quote}.prose :where(blockquote p:last-of-type):not(:where([class~=not-prose] *)):after{content:close-quote}.prose :where(h1):not(:where([class~=not-prose] *)){color:var(--tw-prose-headings);font-size:1.5rem;font-weight:800;line-height:2rem;margin-bottom:.8888889em;margin-top:0}.prose :where(h1 strong):not(:where([class~=not-prose] *)){font-weight:900}.prose :where(h2):not(:where([class~=not-prose] *)){color:var(--tw-prose-headings);font-size:1.25rem;font-weight:700;line-height:1.75rem;margin-bottom:1em;margin-top:2em}.prose :where(h2 strong):not(:where([class~=not-prose] *)){font-weight:800}.prose :where(h3):not(:where([class~=not-prose] *)){color:var(--tw-prose-headings);font-size:1.125rem;font-weight:600;line-height:1.75rem;margin-bottom:.6em;margin-top:1.6em}.prose :where(h3 strong):not(:where([class~=not-prose] *)){font-weight:700}.prose :where(h4):not(:where([class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;line-height:1.5;margin-bottom:.5em;margin-top:1.5em}.prose :where(h4 strong):not(:where([class~=not-prose] *)){font-weight:700}.prose :where(figure>*):not(:where([class~=not-prose] *)){margin-bottom:0;margin-top:0}.prose :where(figcaption):not(:where([class~=not-prose] *)){color:var(--tw-prose-captions);font-size:.875em;line-height:1.4285714;margin-top:.8571429em}.prose :where(code):not(:where([class~=not-prose] *)){color:var(--tw-prose-code);font-size:.875em;font-weight:600}.prose :where(code):not(:where([class~=not-prose] *)):before{content:"`"}.prose :where(code):not(:where([class~=not-prose] *)):after{content:"`"}.prose :where(a code):not(:where([class~=not-prose] *)){color:var(--tw-prose-links)}.prose :where(pre):not(:where([class~=not-prose] *)){background-color:var(--tw-prose-pre-bg);border-radius:.375rem;color:var(--tw-prose-pre-code);font-size:.875em;font-weight:400;line-height:1.7142857;margin-bottom:1.7142857em;margin-top:1.7142857em;overflow-x:auto;padding:.8571429em 1.1428571em}.prose :where(pre code):not(:where([class~=not-prose] *)){background-color:transparent;border-radius:0;border-width:0;color:inherit;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;padding:0}.prose :where(pre code):not(:where([class~=not-prose] *)):before{content:none}.prose :where(pre code):not(:where([class~=not-prose] *)):after{content:none}.prose :where(table):not(:where([class~=not-prose] *)){font-size:.875em;line-height:1.7142857;margin-bottom:2em;margin-top:2em;table-layout:auto;text-align:left;width:100%}.prose :where(thead):not(:where([class~=not-prose] *)){border-bottom-color:var(--tw-prose-th-borders);border-bottom-width:1px}.prose :where(thead th):not(:where([class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;padding-bottom:.5714286em;padding-left:.5714286em;padding-right:.5714286em;vertical-align:bottom}.prose :where(tbody tr):not(:where([class~=not-prose] *)){border-bottom-color:var(--tw-prose-td-borders);border-bottom-width:1px}.prose :where(tbody tr:last-child):not(:where([class~=not-prose] *)){border-bottom-width:0}.prose :where(tbody td):not(:where([class~=not-prose] *)){padding:.5714286em;vertical-align:baseline}.prose{--tw-prose-body:#374151;--tw-prose-headings:#111827;--tw-prose-lead:#4b5563;--tw-prose-links:#111827;--tw-prose-bold:#111827;--tw-prose-counters:#6b7280;--tw-prose-bullets:#d1d5db;--tw-prose-hr:#e5e7eb;--tw-prose-quotes:#111827;--tw-prose-quote-borders:#e5e7eb;--tw-prose-captions:#6b7280;--tw-prose-code:#111827;--tw-prose-pre-code:#e5e7eb;--tw-prose-pre-bg:#1f2937;--tw-prose-th-borders:#d1d5db;--tw-prose-td-borders:#e5e7eb;--tw-prose-invert-body:#d1d5db;--tw-prose-invert-headings:#fff;--tw-prose-invert-lead:#9ca3af;--tw-prose-invert-links:#fff;--tw-prose-invert-bold:#fff;--tw-prose-invert-counters:#9ca3af;--tw-prose-invert-bullets:#4b5563;--tw-prose-invert-hr:#374151;--tw-prose-invert-quotes:#f3f4f6;--tw-prose-invert-quote-borders:#374151;--tw-prose-invert-captions:#9ca3af;--tw-prose-invert-code:#fff;--tw-prose-invert-pre-code:#d1d5db;--tw-prose-invert-pre-bg:rgba(0,0,0,.5);--tw-prose-invert-th-borders:#4b5563;--tw-prose-invert-td-borders:#374151;font-size:1rem;line-height:1.75}.prose :where(p):not(:where([class~=not-prose] *)){margin-bottom:1.25em;margin-top:1.25em}.prose :where(img):not(:where([class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.prose :where(video):not(:where([class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.prose :where(figure):not(:where([class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.prose :where(h2 code):not(:where([class~=not-prose] *)){font-size:.875em}.prose :where(h3 code):not(:where([class~=not-prose] *)){font-size:.9em}.prose :where(li):not(:where([class~=not-prose] *)){margin-bottom:.5em;margin-top:.5em}.prose :where(ol>li):not(:where([class~=not-prose] *)){padding-left:.375em}.prose :where(ul>li):not(:where([class~=not-prose] *)){padding-left:.375em}.prose>:where(ul>li p):not(:where([class~=not-prose] *)){margin-bottom:.75em;margin-top:.75em}.prose>:where(ul>li>:first-child):not(:where([class~=not-prose] *)){margin-top:1.25em}.prose>:where(ul>li>:last-child):not(:where([class~=not-prose] *)){margin-bottom:1.25em}.prose>:where(ol>li>:first-child):not(:where([class~=not-prose] *)){margin-top:1.25em}.prose>:where(ol>li>:last-child):not(:where([class~=not-prose] *)){margin-bottom:1.25em}.prose :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose] *)){margin-bottom:.75em;margin-top:.75em}.prose :where(hr+*):not(:where([class~=not-prose] *)){margin-top:0}.prose :where(h2+*):not(:where([class~=not-prose] *)){margin-top:0}.prose :where(h3+*):not(:where([class~=not-prose] *)){margin-top:0}.prose :where(h4+*):not(:where([class~=not-prose] *)){margin-top:0}.prose :where(thead th:first-child):not(:where([class~=not-prose] *)){padding-left:0}.prose :where(thead th:last-child):not(:where([class~=not-prose] *)){padding-right:0}.prose :where(tbody td:first-child):not(:where([class~=not-prose] *)){padding-left:0}.prose :where(tbody td:last-child):not(:where([class~=not-prose] *)){padding-right:0}.prose>:where(:first-child):not(:where([class~=not-prose] *)){margin-top:0}.prose>:where(:last-child):not(:where([class~=not-prose] *)){margin-bottom:0}.mx-auto{margin-left:auto;margin-right:auto}.my-auto{margin-bottom:auto;margin-top:auto}.mb-6{margin-bottom:1.5rem}.mb-1{margin-bottom:.25rem}.mb-4{margin-bottom:1rem}.mb-2{margin-bottom:.5rem}.block{display:block}.flex{display:flex}.max-w-3xl{max-width:48rem}.max-w-none{max-width:none}.list-inside{list-style-position:inside}.list-disc{list-style-type:disc}.justify-start{justify-content:flex-start}.justify-center{justify-content:center}.gap-6{gap:1.5rem}.gap-2{gap:.5rem}.rounded{border-radius:.25rem}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.bg-slate-100{--tw-bg-opacity:1;background-color:rgb(241 245 249/var(--tw-bg-opacity))}.p-6{padding:1.5rem}.py-10{padding-bottom:2.5rem;padding-top:2.5rem}.px-4{padding-left:1rem;padding-right:1rem}.pt-10{padding-top:2.5rem}.pb-10{padding-bottom:2.5rem}.text-center{text-align:center}.font-serif{font-family:ui-serif,Georgia,Cambria,Times New Roman,Times,serif}.text-2xl{font-size:1.5rem;line-height:2rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.font-semibold{font-weight:600}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55/var(--tw-text-opacity))}.text-gray-900{--tw-text-opacity:1;color:rgb(17 24 39/var(--tw-text-opacity))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128/var(--tw-text-opacity))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81/var(--tw-text-opacity))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175/var(--tw-text-opacity))}.shadow{--tw-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px -1px rgba(0,0,0,.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}html{font-family:-apple-system,Meiryo,"sans-serif"}body{word-wrap:break-word}a{color:#dc4e47;text-decoration:none}a:hover{text-decoration:underline}.gatsby-resp-image-figcaption{text-align:center}.last\:mb-0:last-child{margin-bottom:0}.hover\:no-underline:hover{-webkit-text-decoration-line:none;text-decoration-line:none}.hover\:shadow-md:hover{--tw-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -2px rgba(0,0,0,.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style><style type="text/css">
    .header-link.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .header-link.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .header-link svg,
    h2 .header-link svg,
    h3 .header-link svg,
    h4 .header-link svg,
    h5 .header-link svg,
    h6 .header-link svg {
      visibility: hidden;
    }
    h1:hover .header-link svg,
    h2:hover .header-link svg,
    h3:hover .header-link svg,
    h4:hover .header-link svg,
    h5:hover .header-link svg,
    h6:hover .header-link svg,
    h1 .header-link:focus svg,
    h2 .header-link:focus svg,
    h3 .header-link:focus svg,
    h4 .header-link:focus svg,
    h5 .header-link:focus svg,
    h6 .header-link:focus svg {
      visibility: visible;
    }
  </style></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="bg-slate-100"><div class="container max-w-3xl mx-auto pb-10 pt-10"><h3 class="text-2xl font-bold text-center"><a class="hover:no-underline text-gray-900 font-serif" href="/">Yucchiy&#x27;s Note</a></h3></div><main><div class="container bg-white rounded shadow hover:shadow-md max-w-3xl mx-auto p-6"><article><header class="mb-6"><div><time class="text-sm text-gray-500 mb-1">September 28, 2020</time><h1 class="text-xl font-semibold text-gray-700 mb-1">Unity2019.1から導入されたEditorToolの紹介</h1><div class="flex justify-start gap-2"><span class="text-sm text-gray-500">Tags: </span><a class="text-sm text-gray-400" href="/tags/unity/">Unity</a><a class="text-sm text-gray-400" href="/tags/editor-tools/">Editor Tools</a><a class="text-sm text-gray-400" href="/tags/エディタ拡張/">エディタ拡張</a></div></div></header><div class="prose max-w-none"><p>UTJが主催する<a href="https://www.youtube.com/watch?v=2lFZRROZ5cw">「ゆるふわLT大会」という勉強会の第1回目</a>が、2020年の7月17日に開催されていました。
この勉強会で、Editor Toolsと呼ばれるAPIについての紹介がありました。</p>
<p>こちらのAPIは2019.1から正式に利用可能になっていたようですが、リリースノートにその記載はなく、また、情報自体も少ないです。</p>
<p>簡単に触ってみたので、備忘録としてブログに綴りたいと思います。</p>
<h2 id="editor-toolsとは" style="position:relative;"><a href="#editor-tools%E3%81%A8%E3%81%AF" aria-label="editor toolsとは permalink" class="header-link before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Editor Toolsとは</h2>
<p>まず、そもそもEditor Toolsとはなんなのかについておさえていきましょう。先述の勉強会の1スライドから引用すると、「SceneView上でGameObjectやComponentを操作しやすくする機能を実装するためのAPI」とのことです。</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/1b9da40091c91489fd6f4da32dba405f/d7ceb/whats-editor-tools.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 55.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACCklEQVQoz31RXW8SQRTdfwP9E+JvMZqCPrTxxfgVHvwFxsQ0VVN98LEPrZHEKEFSkCoREuguxAX3+1PYzrp0WZaFY2YAkZA4ycm5c+fMPffOcGLqFpTULuRUdgtKOgclvYxTa1bTOQZ2vrOO1Z0cuNAaAEEE+CFArtZMRhjbQ4ZkGCAe+At2Ceid0B4itNZYabnjd+9x484+9u49wt0Heezdf4zbD/PYzz/Br0sPhm3hw6ePqDe+4+xLFaZj43+L+1w+w9NnBzh8+Zrh4MURnh8e4dWbt9BUDaMggKHrcGwHlmnCJwTj8RjRX0QYhyFmSQLM5+CiOAbxCSzLAiGXW469Xg+VSgWNRgM8z6NYLKJQKKBUKqFWq6FcLqNarTIT1qHtE3i+j+B3gNHoCnEcYzKZMEGSJDBNE7quw/M8DAYDdLtdiKLIWFVV9Pt9xlEULQoaPoGk64gnE5aYzWaYz+eMk2TGDGhheoEyPVstakxz0+mU6VhByXVgOS4cw4I39FgnPvFZN5Tpu9Fxv56fo9lsov6tjlarxTprt9tsAgpCCDPlWqIISZIh/+hD+ilBUVU2wgqapkFRFKiaClmWIUkSJFlmecMw4DgOXNeFbdvsHzjqygsC2vwFe/QtCAKETgfCkjtL0D0vLDQX/+i542s3cXo9u4ETypnlPpPFSWYXpxvIbsYrfSaLP2/Z7kxK8oU4AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Editor Toolsについて"
        title="Editor Toolsについて"
        src="/static/1b9da40091c91489fd6f4da32dba405f/5a190/whats-editor-tools.png"
        srcset="/static/1b9da40091c91489fd6f4da32dba405f/772e8/whats-editor-tools.png 200w,
/static/1b9da40091c91489fd6f4da32dba405f/e17e5/whats-editor-tools.png 400w,
/static/1b9da40091c91489fd6f4da32dba405f/5a190/whats-editor-tools.png 800w,
/static/1b9da40091c91489fd6f4da32dba405f/c1b63/whats-editor-tools.png 1200w,
/static/1b9da40091c91489fd6f4da32dba405f/d7ceb/whats-editor-tools.png 1446w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span>
    <figcaption class="gatsby-resp-image-figcaption"><p>Editor Toolsについて</p></figcaption>
  </figure></p>
<p>これだけではイメージが付きづらいので、実際にEditor Toolsが利用されている箇所を示すスライドを下図に引用します。</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/677be88ff1b34d01be90b34436f7f7f8/fe720/editor-tools-in-unityeditor.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACqUlEQVQoz02Qy09TaRiHz0r/A6IWjBsyUcfon6AxXsAFujCOM9FEt5oYYzUuqO1IC1prWyvaC8X29PRyrrbEGy0UEHRDBpyEFaEmNpVjMo6gK0uCeSbnUEe/5Mn3Xr783t/7CfXDvVg0jrgwu9x86Pbw4difLHe5/8fs8mD+VHt/1I3Z7eFjj49/j/fb9z89PhpdboS1tTXWv32jUX/HxFiZ6YlJnuUlqqMvmBqvMjY6SrU8youREcbLZSbGxpiqVhmvlFELebJimpdTkywuLrK6uopA6zQaDWRZoVAoMBiJkEqlyGazNplUmlB/P7F4nFgsipgRcTqdtLW10dHRQWdnJw6Hg0qlglCv15mZnkaRZXp7XSiyQjKZtIV1TUPTVDRNQ9d1JEkil80iSTli0SgDAwP09fVRKpZYWFhgZWUFIRAIIAiCPWnzpk32I8uVqqooioJmaKiaag+yapa4VVcUmWKxRLFYpFarfV8UwTRN5ubmMAyDm14fGWlDTFVUNFm2nemGYTu1Y123+1lJ2thC15mfn6fZbLK+vv7jD9/WahQ0wyafy22IqpYTFVXTyWUypJNJxOFHDCcSJBIJhoaGiEajLC0t/XD45fNnml+b/DU7S2xoGFHKk06lyIgiYloknU7bA65fvMCJQwfp3n+Ai+fOk4jH8fv9XLt61e7//eYN5rKJ0DCX+bjyiZevZrgTCjIYjRJ5MEgoco9gJEzwXphAKIjX24fL1YvHc4NwOMRl5xW2tjvY1tFO+47tbHFsI6/ICPOTr1l4PcvzgkHQ4+O+z0/Ee5uI18/9FlY+OBDg4a0gD27dtbnr9uK+fA3XJSfxO2FKmQIzzyoI6i8nsTB2nqL06+8Uv7P7dAsrb8W7Wuw+zcieP3i676zNk71nbB7v/I3/AANzbmAusDT2AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Editor Toolsのエディタでの利用箇所"
        title="Editor Toolsのエディタでの利用箇所"
        src="/static/677be88ff1b34d01be90b34436f7f7f8/5a190/editor-tools-in-unityeditor.png"
        srcset="/static/677be88ff1b34d01be90b34436f7f7f8/772e8/editor-tools-in-unityeditor.png 200w,
/static/677be88ff1b34d01be90b34436f7f7f8/e17e5/editor-tools-in-unityeditor.png 400w,
/static/677be88ff1b34d01be90b34436f7f7f8/5a190/editor-tools-in-unityeditor.png 800w,
/static/677be88ff1b34d01be90b34436f7f7f8/c1b63/editor-tools-in-unityeditor.png 1200w,
/static/677be88ff1b34d01be90b34436f7f7f8/fe720/editor-tools-in-unityeditor.png 1448w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span>
    <figcaption class="gatsby-resp-image-figcaption"><p>Editor Toolsのエディタでの利用箇所</p></figcaption>
  </figure></p>
<p>どうやら普段から頻繁に利用している、GameObjectを移動させるツール（MoveTool）などもこのAPIを利用して実装されていそうです。
勉強会中では「いままでもこのAPIを利用しなくてもこのような機能は実装できた」といわれていましたが（自分は作ったことがないのでわからないですが）、規格を整備するためにAPI化してリリースし直したというような文脈のようです。</p>
<h2 id="editor-toolsに触れてみる" style="position:relative;"><a href="#editor-tools%E3%81%AB%E8%A7%A6%E3%82%8C%E3%81%A6%E3%81%BF%E3%82%8B" aria-label="editor toolsに触れてみる permalink" class="header-link before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Editor Toolsに触れてみる</h2>
<p>Editor Toolsが何者かなんとなく理解できたところで、このAPIになれるため、標準機能である「MoveTool」を自作してみたいと思います。</p>
<p>早速ですが、実装した「MyMoveTool」のコードの全容を示します。</p>
<div class="gatsby-highlight" data-language="cs"><pre class="language-cs"><code class="language-cs"><span class="token keyword">using</span> <span class="token namespace">UnityEditor</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEditor<span class="token punctuation">.</span>EditorTools</span><span class="token punctuation">;</span>

<span class="token comment">/// &lt;summary></span>
<span class="token comment">/// Move Toolをスクラッチ実装してみる</span>
<span class="token comment">/// &lt;/summary></span>
<span class="token punctuation">[</span><span class="token function">EditorTool</span><span class="token punctuation">(</span><span class="token string">"Examples/My Move Tool"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyMoveTool</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">EditorTool</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnToolGUI</span><span class="token punctuation">(</span><span class="token class-name">EditorWindow</span> window<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// これ以降に定義されるGUIの変更を監視する</span>
        EditorGUI<span class="token punctuation">.</span><span class="token function">BeginChangeCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// ハンドルの現在のワールド座標を取得する</span>
        <span class="token class-name"><span class="token keyword">var</span></span> position <span class="token operator">=</span> Handles<span class="token punctuation">.</span><span class="token function">PositionHandle</span><span class="token punctuation">(</span>Tools<span class="token punctuation">.</span>handlePosition<span class="token punctuation">,</span> Tools<span class="token punctuation">.</span>handleRotation<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 監視してたGUIが変更されていればこのif内に入る</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>EditorGUI<span class="token punctuation">.</span><span class="token function">EndChangeCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// この移動をUndoしたときに戻せるように履歴を保存しておく</span>
            Undo<span class="token punctuation">.</span><span class="token function">RecordObjects</span><span class="token punctuation">(</span>Selection<span class="token punctuation">.</span>transforms<span class="token punctuation">,</span> <span class="token string">"MyMoveTool"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 直前のハンドル位置からどれだけ移動したかを計算する</span>
            <span class="token class-name"><span class="token keyword">var</span></span> deltaPosition <span class="token operator">=</span> position <span class="token operator">-</span> Tools<span class="token punctuation">.</span>handlePosition<span class="token punctuation">;</span>
            <span class="token comment">// そしてその差分を現在ヒエラルキーで選択しているすべてのオブジェクトに対して適用する</span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> selectionTransform <span class="token keyword">in</span> Selection<span class="token punctuation">.</span>transforms<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                selectionTransform<span class="token punctuation">.</span>position <span class="token operator">+=</span> deltaPosition<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>エディター上での動作は、下図のとおりです。まずはじめに「MyMoveTool」によってCube_0 ~ 3のPositionをまとめて操作して、その後に同じ動作を標準で用意されている「MoveTool」で行っています。標準のツールと同様の挙動が実現できていることが確認できるかと思います。</p>
<p><img src="/1f44de14c26031f4a8428f66c79e9aec/mymovetool-vs-movetool.gif" alt="エディター上でのMyMoveToolの動作"></p>
<p>こちらの実装について、順を追って説明します。</p>
<h3 id="editortoolの定義" style="position:relative;"><a href="#editortool%E3%81%AE%E5%AE%9A%E7%BE%A9" aria-label="editortoolの定義 permalink" class="header-link before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>EditorToolの定義</h3>
<p>独自のEditor Toolsを実装するには、実装するクラスが<a href="https://docs.unity3d.com/ScriptReference/EditorTools.EditorTool.html">EditorTool</a>を継承する必要があります。
また、エディターにそのクラスを登録するために、<a href="https://docs.unity3d.com/ScriptReference/EditorTools.EditorToolAttribute.html">EditorToolAttribute</a>を設定します。</p>
<div class="gatsby-highlight" data-language="cs"><pre class="language-cs"><code class="language-cs"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">EditorTool</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Examples/My Move Tool"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyMoveTool</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">EditorTool</span></span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span></code></pre></div>
<p><code>EditorToolAttribute</code>の第1引数には<code>displayName</code>を設定します。これはエディター中の下図の箇所での表示に利用される文字列です。
<code>/</code>（スラッシュ）で区切ると（<code>MenuItem</code>などと同様で）階層的に表示できます。プロジェクトによって独自のEditor Toolsの数が増える場合はルールを決めておくと管理がしやすくなるでしょう。</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 528px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/59c8ebf9d0496db31bb2d5ee837bae78/4af8e/recognizing-mymovetools-in-unityeditor.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 48.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACgElEQVQozy2S20tUURjFz/9h2UBXvMycmTPnnDlz5jjj5cyUM44zOeII0T3FcTSknroYPQVlBBZ0edLCCk2C3oMSNYpCM62UHoq0sDA0KOmhfrF3PSz2t2F/61vrW1sJh21U1Y+mBTFNE8MwCQaDRByHAwcPoWsadjiMYZpYpolphuSbgN9PSckGNm4sZZPHI8/STR6UeDxOLBaTZF5vJT6fD6/Xi9/vJ5PJELFtCcMwCIdMQqaBE7HRVB9bt2xG9XnZsX2bhMfjQXHdODU1Nei6LokEKioqKSsro7y8nPpkkoaGBhKJhBwasmyamltJ7Gqgui5BfSrDzvo06UyO3bk8Sm1tLc3NzeTzeQlR19XVySG2beO6riRLJHZihXRaDh+n/8E7+kZmuDA8w/nhV/SNzHHx3msu3Z9HUVWVVCpFLpejsbGRpqYmxBqEYl0P/h/WIlW6tdXs6+rlzvN1Bse/cXNyTWJwYpXBiTUGJtZQAoEAQqUgk02uK5WJnYkghLJkMkkoZGGZBod6ehl5scrQ5GduP1nm7rMVRqd/MDr9k9GX6yiapmFZFtlsVsJxHJmiZWhsjRfR2wZw2q+zfc8NNrdcJt5+jt4rtzhzdZgT/UOcunaPh+9/8XjpD48Wf6OINCORCOl0WloXtbBrGDpq0CK/t439R4q4qRxlaojiybNMrXznyeIyT5e+MPV1lQ/AR2ARUIQ9YbW1tVXuS9gX30igyrGpjlVRUx3FsS30gMrx06eYWvrExPwCkwsLjL95y9jsHGOzszyeeYUi7IpmEYogFIEI29FolKqqqKz/3WPYkQjZTJZjPT0cLRbp7uykq1Cgu7NAd6FAV0cHfwFM96bgnJXtvgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="MyMoveToolがエディターに認識される様子"
        title="MyMoveToolがエディターに認識される様子"
        src="/static/59c8ebf9d0496db31bb2d5ee837bae78/4af8e/recognizing-mymovetools-in-unityeditor.png"
        srcset="/static/59c8ebf9d0496db31bb2d5ee837bae78/772e8/recognizing-mymovetools-in-unityeditor.png 200w,
/static/59c8ebf9d0496db31bb2d5ee837bae78/e17e5/recognizing-mymovetools-in-unityeditor.png 400w,
/static/59c8ebf9d0496db31bb2d5ee837bae78/4af8e/recognizing-mymovetools-in-unityeditor.png 528w"
        sizes="(max-width: 528px) 100vw, 528px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span>
    <figcaption class="gatsby-resp-image-figcaption"><p>MyMoveToolがエディターに認識される様子</p></figcaption>
  </figure></p>
<p>第2引数に<code>targetType</code>を指定します。このEditorToolが編集できるクラスの型を指定できます。この引数は省略することが可能で、その場合はすべての型を編集対象として扱うことを意味します。</p>
<p>この引数を指定すると、後述する<code>OnToolGUI</code>内で<code>target</code>および<code>targets</code>プロパティに入るオブジェクトは、その型のインスタンスが設定されます。指定しない場合は<code>GameObject</code>が渡されます。</p>
<h3 id="ontoolguiによる定期処理" style="position:relative;"><a href="#ontoolgui%E3%81%AB%E3%82%88%E3%82%8B%E5%AE%9A%E6%9C%9F%E5%87%A6%E7%90%86" aria-label="ontoolguiによる定期処理 permalink" class="header-link before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>OnToolGUIによる定期処理</h3>
<p>ボタンを押すなどしてツールがアクティブになると、<code>OnToolGUI(EditorWindow window)</code>が毎フレーム呼び続けられます。つまりツールの実装は、このメソッド内に記述していくことになります。</p>
<p>標準の「Move Tool」では、下図のように、<a href="https://docs.unity3d.com/ScriptReference/Handles.PositionHandle.html">Handles.PositionHandle</a>を用いてオブジェクトの位置をユーザーに操作させて、ヒエラルキー上で選択中のすべてのオブジェクトに対してその位置更新を適用させます。</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/82328c020f4806c7906b2c29d5aa4572/561da/movetool-description.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 54%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACJElEQVQoz3WQbU/TYBSG+1swUfxAlu6VUOIwhSHoxkYpdO3abl3pupUxEOLCwEFAjRjMDDG+fSH+Cf/eZfrAUCJ+uHKSJ/e5zpNbWikWeZrPo87NcdTvcz58zbudHVrlFS4PD9iNOoS+z1YYsqCqJGWZxNQUjycnmXz4iAcTE4JMKk1KTiKpqoo6P89qpcLb4yHvz844ORzgmAbfRhf8uBzx/XLE1dfPdNsBy0uLrK1WMDd09NUVnj8rsLy4wNLSPEvPVKTp6Wl0XUfTNFLpDHJSxq3qRL6LW127xtBwDI2gbtFv1xj2moSeQzeos93y2PLrDA5eMtiLkAqFApZlCUrFEpVymVajRqdpE226tOoWF8M2Z/s+XbdB1ylz1Fmn16jR8mq049mw2A48Ir+BlM1myefzAkVRyOef4DtVIQzjBc8mtMt0XY29pksYOHSsEr26RcuzaYvMNYFbRZJlmVg6RpmZwXcMIWw3rBtqRE2bjqnx6XjAr59XfOz7nO77+HaVzlhYN5GSySRxjzG5XI5ZRcG3DREKb4UWgWuyHzU4H77i4s0JPd9kq2kS1v8cbbn3Cmfw7Y1boZB6NTxTZ3S6y5cPA4zKC0LPFv3eZsTR6r9CJRbWNkQgXrjGFMVv2jqBa4gD4zcx66aQBo6BlEql7v5wVhGXIt8RPd7hvrcb4o5jqZRIJMhkMkKWTqfJZbOsV4pYehlzrYw5nv/jr5yhlfgNgM2/+Lka9qIAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="標準のMove Toolの操作の様子"
        title="標準のMove Toolの操作の様子"
        src="/static/82328c020f4806c7906b2c29d5aa4572/5a190/movetool-description.png"
        srcset="/static/82328c020f4806c7906b2c29d5aa4572/772e8/movetool-description.png 200w,
/static/82328c020f4806c7906b2c29d5aa4572/e17e5/movetool-description.png 400w,
/static/82328c020f4806c7906b2c29d5aa4572/5a190/movetool-description.png 800w,
/static/82328c020f4806c7906b2c29d5aa4572/561da/movetool-description.png 969w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span>
    <figcaption class="gatsby-resp-image-figcaption"><p>標準のMove Toolの操作の様子</p></figcaption>
  </figure></p>
<p>ハンドルの位置および回転は「ピボットモード」が「Pivot」か「Center」か、「ピボットローテーション」が「Local」か「World」によって異なります。
具体的には、オブジェクトが複数選ばれた場合、「ピボットモード」が「Pivot」の場合は、はじめに選択したオブジェクトの位置にハンドルが設置されます。一方「Center」の場合は複数オブジェクトの位置の重心にハンドルが設定されます。
また、「ピボットローテーション」が「Local」の場合はローカル座標の回転がハンドルに設定され、「Global」の場合はワールド座標の回転がハンドルに設定されます。</p>
<p>それぞれのモードを考慮したハンドルの位置および回転は、<a href="https://docs.unity3d.com/ScriptReference/Tools.html">UnityEditor.Tools</a>に実装されている、<a href="https://docs.unity3d.com/ScriptReference/Tools-handlePosition.html">handlePosition</a>と<a href="https://docs.unity3d.com/ScriptReference/Tools-handleRotation.html">handleRotation</a>から取得できます。</p>
<p><code>MyMoveTool</code>では下記のように、<code>PositionHandle</code>の引数である位置と回転をそれぞれ<code>Tools.handlePosition</code>および<code>Tools.handleRotation</code>を指定しています。</p>
<p>Editor Toolsは直接関係ないのですが、<code>MyMoveTool</code>では<code>EditorGUI.BeginChangeCheck()</code>と<code>EditorGUI.EndChangeCheck()</code>を利用してGUIでの値変更を監視して、実際に値が変化した場合のみ、位置の更新処理を行っています。</p>
<div class="gatsby-highlight" data-language="cs"><pre class="language-cs"><code class="language-cs"><span class="token comment">// これ以降に定義されるGUIの変更を監視する</span>
EditorGUI<span class="token punctuation">.</span><span class="token function">BeginChangeCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// -- ここから変更監視 ---</span>

<span class="token comment">// PositionHandleを描画して、ユーザがハンドルを移動させた位置を取得する</span>
<span class="token class-name"><span class="token keyword">var</span></span> position <span class="token operator">=</span> Handles<span class="token punctuation">.</span><span class="token function">PositionHandle</span><span class="token punctuation">(</span>Tools<span class="token punctuation">.</span>handlePosition<span class="token punctuation">,</span> Tools<span class="token punctuation">.</span>handleRotation<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// --- ここまで変更監視 ---</span>
<span class="token comment">// 監視してたGUIが変更されていればこのif内に入る</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>EditorGUI<span class="token punctuation">.</span><span class="token function">EndChangeCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// ここで更新処理</span>
<span class="token punctuation">}</span></code></pre></div>
<p>あとは、ヒエラルキー上で選択されているすべてのオブジェクトに対してハンドルの移動を適用します。
ヒエラルキーで選択されている<code>Transform</code>の一覧は<a href="https://docs.unity3d.com/ScriptReference/Selection-transforms.html">Selection.transforms</a>で取得できるので、すべてのオブジェクトに対して<code>（ユーザーによって移動されたハンドル位置 - その前のハンドル位置）</code>を足し合わせることで移動を適用します。Undoにも対応できるように、<code>Undo.RecordObjects</code>を呼び出して直前の位置を記録しておきます。</p>
<p>ちなみに<code>Selection.transforms</code>の代わりに<a href="https://docs.unity3d.com/ScriptReference/EditorTools.EditorTool-targets.html">EditorTool.targets</a>で代用することも可能です。 <code>EditorTool.targets</code>には、ヒエラルキー上で指定したオブジェクトの、<code>GameObject</code>の一覧が格納されています。なので、<code>GameObject</code>にキャストした後、<code>transform</code>プロパティを経由して<code>position</code>を更新することで同様のことができますが、わざわざそれらの処理をするのも手間なので（あと、EditorToolのドキュメントのサンプルコードがこのような実装にしてたため）、今回は<code>Selection.transforms</code>を用いました。</p>
<div class="gatsby-highlight" data-language="cs"><pre class="language-cs"><code class="language-cs"><span class="token comment">// この移動をUndoしたときに戻せるように履歴を保存しておく</span>
Undo<span class="token punctuation">.</span><span class="token function">RecordObjects</span><span class="token punctuation">(</span>Selection<span class="token punctuation">.</span>transforms<span class="token punctuation">,</span> <span class="token string">"MyMoveTool"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 直前のハンドル位置からどれだけ移動したかを計算する</span>
<span class="token class-name"><span class="token keyword">var</span></span> deltaPosition <span class="token operator">=</span> position <span class="token operator">-</span> Tools<span class="token punctuation">.</span>handlePosition<span class="token punctuation">;</span>
<span class="token comment">// そしてその差分を現在ヒエラルキーで選択しているすべてのオブジェクトに対して適用する</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> selectionTransform <span class="token keyword">in</span> Selection<span class="token punctuation">.</span>transforms<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    selectionTransform<span class="token punctuation">.</span>position <span class="token operator">+=</span> deltaPosition<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>以上で、標準の「Move Tool」スクラッチで実装することができました。コード量はかなり少なく実装できました。</p>
<h2 id="editor-toolsシーンビュー中でguiを使う" style="position:relative;"><a href="#editor-tools%E3%82%B7%E3%83%BC%E3%83%B3%E3%83%93%E3%83%A5%E3%83%BC%E4%B8%AD%E3%81%A7gui%E3%82%92%E4%BD%BF%E3%81%86" aria-label="editor toolsシーンビュー中でguiを使う permalink" class="header-link before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Editor Tools（シーンビュー）中でGUIを使う</h2>
<p>勉強会では、下図のようにEditor ToolsとGUIを組み合わせて、コンポーネントのプロパティをシーンビュー上で編集する機能が紹介されていました。</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/6e263fc452d56b83fac60cd2457c3557/bd9eb/editortools-with-gui.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 60.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAADIUlEQVQozz3Ra0+TZxjA8b5d9gWWbEHaAvb0nHpi06Y8ENFQA6ztgILLolPoGAUjW4UekE2Uw5izMjms1EI5rSlhVhDYUESjWQxuy9xiFvcJ9i3+SwvxxT937je/3Nd1a4b7vmAsGuXbWJzv4ldIxAcZ6YswEOohFupmoLuH6+HLfHXxErGuEH3BTsLtHYyE+7kRH2CsP1JstD/KaF8UTaXTgc3uwGI0Y3XakNxO7DY7gmRBNotIZgFRFhAsFhRRwmwwUq7XYxaOIgsiDpsNWRQxG40IZjMaWVGoOulBkqw4VCcfXDhGoKeZQLiVE511+CM+zkVbaeit57Ohc5zs9vBp5DyNoTZsxysRZBFFUVCs1uKpkWQZ1ePFrNgJHFP4I+gh36MyO+sltNnCyurn3B4PMTUTJDnRzeQ3ASZGWkjfi3LhyyCCRcBaAA/TiAXwtB+TbOdsXS3/5VLcUgWiLi3pRCsPn/3A6509/sklePbwKcP+WuKfNHM1VE9vlweLYkWR5SImy/IBWHXah9Escr6jg+1EmPFT5Qy5Stjs9bIQP8PeWBcv01d59ftfDLYH+Kj2OG0BL2fVMiRROnidLB+AgiSh1jdjEa2caWnm10eP2d3aYnsjz056nhfZuywlp1hbybL/299s5NfJZVfZf/kv1wYGMBkNWA/3VwSdle9T6a7BYBJoa2pk/fuv2b/oZHe0kyf7f/Lk+QuGLgVpckvcHAzzei/P8/R1Xu3mmZ6dx1L4/cP9FcGa6mqcDjsmo5EPfV6y8zOsNr7Dzc4ADx495ecHj5keinK5TmTUYyDTUMJ8zVvsxJoYv3ELg+EooigiCEIxjdvtxuVyodeV4vG3sXM7zsiJIywsr3J/6xfurW/yU36D/N3CqDnuJFNMJxLF+7XhUcrLyzGZTG/SOBwOZEmipFRLQ62bdP27RD728uPaOpmFZZaWs2QWV4rw/c1tsrk1FldypNIZ+iMx9Ho9FRUVb9LodDr0Oh3vleo5JR1hwv02V9rbSM4tMTk5w9RMikwqxeKdJHNzGXw+P4WpVLUKVa2mrKwMrVZLwSn0P+aXBDDOlFFIAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Editor Tools内でGUIを呼び出してコンポーネントのプロパティをシーン上で編集させる様子"
        title="Editor Tools内でGUIを呼び出してコンポーネントのプロパティをシーン上で編集させる様子"
        src="/static/6e263fc452d56b83fac60cd2457c3557/5a190/editortools-with-gui.png"
        srcset="/static/6e263fc452d56b83fac60cd2457c3557/772e8/editortools-with-gui.png 200w,
/static/6e263fc452d56b83fac60cd2457c3557/e17e5/editortools-with-gui.png 400w,
/static/6e263fc452d56b83fac60cd2457c3557/5a190/editortools-with-gui.png 800w,
/static/6e263fc452d56b83fac60cd2457c3557/c1b63/editortools-with-gui.png 1200w,
/static/6e263fc452d56b83fac60cd2457c3557/bd9eb/editortools-with-gui.png 1442w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span>
    <figcaption class="gatsby-resp-image-figcaption"><p>Editor Tools内でGUIを呼び出してコンポーネントのプロパティをシーン上で編集させる様子</p></figcaption>
  </figure></p>
<p>こちらはEditor Toolsがこのような機能を持っているわけではないので、直接関係ないのですが、かなり便利な使い方だと感じたので、（これが正攻法なのかはわかりませんが）紹介したいと思います。</p>
<p>今回は、以下の<code>Player</code>クラスのプロパティを、シーンビュー上で編集するEditor Toolsを実装してみます。</p>
<div class="gatsby-highlight" data-language="cs"><pre class="language-cs"><code class="language-cs"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Player</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">SerializeField</span></span><span class="token punctuation">]</span> <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">string</span></span> _name<span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">SerializeField</span></span><span class="token punctuation">]</span> <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">int</span></span> _power<span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">SerializeField</span></span><span class="token punctuation">]</span> <span class="token keyword">private</span> <span class="token class-name">PlayerType</span> _playerType<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">PlayerType</span>
    <span class="token punctuation">{</span>
        Attacker<span class="token punctuation">,</span>
        Defender<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>具体的には、下記のようなプロパティ編集用のGUIを表示し、シーンビュー上で<code>Player</code>ビヘイビアーのプロパティを編集するツールを作成します。</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/fe7f1bb0cbaebe7b511b5a76dd8c43d0/bb051/playerleveleditotool.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 47%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACN0lEQVQoz22S60uTYRjG99fUh4jyPWzvu71b294d2rQt15abuoPTHdoh52E6QqeZgaRIUkFEH0L/iKIM+hgEnYgoij4HIUiklQa/eJ/6FH24uG4e7uvHfXM/tmAwSDgc4pTHjXTiOGf6U3Su3WFm5TZz6/eYv75Jd2OL7sYmize3uLR+l/bKLWZXbzCQHxU5p9OFoij4/X5smidAIpOjN5Gmx+Gm0p7nxc4Bzz7v8fzLPi93fvBm9yfvvh7wYe+QT99/8fHbIe9395m7uoxL1/H5fDidTjweDzZZ9+IyI+jeMD1OP9FYgk57kpmpcdqTF2lPNJluNWk1azRqZZq1Cs16lamJFslUCsPtFjBVVYVssnQSh6qg2VVURSJkeqmOZCkOpRnLZqgUhmmMZpmfbrK2tMDqUpe15UVWL3c5l4pzOhohHo/j9XoJBALYZFlB0zQ0TUdV7YSCJvWxHAudcToTNWrFYQZiXq5MVXm7/YBXj+7z+sk2Tx8/ZCCZwDAMkbemtNwmy/JfoCZGDgX8NEo5wgEDp0OiUcpzPuQmaTrJp85iOOxk+sKUc2n6omEURUWWJJG1WP8F1kezHDt6BMOhiHp8LM9stUirOEw9m6ZZGKJZytMf68Mw3OIYVtZut/8LtAugtWarMsJ4ucCFkSEqhUGhquX5DOV8RnisN4LLMHC5XOi6jiRJf4AOh0NIUVWCpk8ES7k0pVyGcmFQAKy3bDpJPHaGcDAg+nqjEXEI0zTFH7T8NzZ7ddET2rMmAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="今回作成するPlayerプロパティ編集ツール"
        title="今回作成するPlayerプロパティ編集ツール"
        src="/static/fe7f1bb0cbaebe7b511b5a76dd8c43d0/5a190/playerleveleditotool.png"
        srcset="/static/fe7f1bb0cbaebe7b511b5a76dd8c43d0/772e8/playerleveleditotool.png 200w,
/static/fe7f1bb0cbaebe7b511b5a76dd8c43d0/e17e5/playerleveleditotool.png 400w,
/static/fe7f1bb0cbaebe7b511b5a76dd8c43d0/5a190/playerleveleditotool.png 800w,
/static/fe7f1bb0cbaebe7b511b5a76dd8c43d0/c1b63/playerleveleditotool.png 1200w,
/static/fe7f1bb0cbaebe7b511b5a76dd8c43d0/bb051/playerleveleditotool.png 1212w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span>
    <figcaption class="gatsby-resp-image-figcaption"><p>今回作成するPlayerプロパティ編集ツール</p></figcaption>
  </figure></p>
<p>このツールのエディター上での動作は下図のとおりです。</p>
<p><img src="/af165f570cfffd5c4908039c3901e341/playerleveledittool.gif" alt="Playerのプロパティをシーン上で編集する様子"></p>
<p>このツールは「PlayerLevelEditTool」と名付けます。このクラスの実装は下記のとおりです。</p>
<div class="gatsby-highlight" data-language="cs"><pre class="language-cs"><code class="language-cs"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEditor</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEditor<span class="token punctuation">.</span>EditorTools</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">EditorTool</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Example/Player/Level Edit"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">Player</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PlayerLevelEditTool</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">EditorTool</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnToolGUI</span><span class="token punctuation">(</span><span class="token class-name">EditorWindow</span> window<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> obj <span class="token keyword">in</span> targets<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> player <span class="token operator">=</span> obj <span class="token keyword">as</span> <span class="token class-name">Player</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> guiPoint <span class="token operator">=</span> HandleUtility<span class="token punctuation">.</span><span class="token function">WorldToGUIPoint</span><span class="token punctuation">(</span>player<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name"><span class="token keyword">var</span></span> serializedObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SerializedObject</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

            Handles<span class="token punctuation">.</span><span class="token function">BeginGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name"><span class="token keyword">var</span></span> nameProperty <span class="token operator">=</span> serializedObject<span class="token punctuation">.</span><span class="token function">FindProperty</span><span class="token punctuation">(</span><span class="token string">"_name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            EditorGUI<span class="token punctuation">.</span><span class="token function">PropertyField</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rect</span><span class="token punctuation">(</span>guiPoint <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nameProperty<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name"><span class="token keyword">var</span></span> powerProperty <span class="token operator">=</span> serializedObject<span class="token punctuation">.</span><span class="token function">FindProperty</span><span class="token punctuation">(</span><span class="token string">"_power"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            EditorGUI<span class="token punctuation">.</span><span class="token function">PropertyField</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rect</span><span class="token punctuation">(</span>guiPoint <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> powerProperty<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name"><span class="token keyword">var</span></span> playerTypeProperty <span class="token operator">=</span> serializedObject<span class="token punctuation">.</span><span class="token function">FindProperty</span><span class="token punctuation">(</span><span class="token string">"_playerType"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            EditorGUI<span class="token punctuation">.</span><span class="token function">PropertyField</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rect</span><span class="token punctuation">(</span>guiPoint <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> playerTypeProperty<span class="token punctuation">)</span><span class="token punctuation">;</span>

            serializedObject<span class="token punctuation">.</span><span class="token function">ApplyModifiedProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            Handles<span class="token punctuation">.</span><span class="token function">EndGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>順を追って説明します。</p>
<h3 id="editortoolattributeで型を指定する" style="position:relative;"><a href="#editortoolattribute%E3%81%A7%E5%9E%8B%E3%82%92%E6%8C%87%E5%AE%9A%E3%81%99%E3%82%8B" aria-label="editortoolattributeで型を指定する permalink" class="header-link before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>EditorToolAttributeで型を指定する</h3>
<p>前述しましたが、<code>EditorToolAttribute</code>の第2引数で編集できる型を指定しています。具体的には下記のように記述します。</p>
<div class="gatsby-highlight" data-language="cs"><pre class="language-cs"><code class="language-cs"><span class="token comment">// 第２引数に typeof(Player) を渡すことで、Playerクラスのビヘイビアが</span>
<span class="token comment">// アタッチされたオブジェクトを選択した場合のみこの拡張は有効になる</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">EditorTool</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Example/Player/Level Edit"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">Player</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PlayerLevelEditTool</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">EditorTool</span></span>
<span class="token punctuation">{</span>
<span class="token comment">// ...</span></code></pre></div>
<p>ここで型を指定することで、下記のように<code>OnToolGUI</code>内の<code>targets</code>には、<code>Player</code>クラスのインスタンスが格納されるようになります。</p>
<div class="gatsby-highlight" data-language="cs"><pre class="language-cs"><code class="language-cs"><span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnToolGUI</span><span class="token punctuation">(</span><span class="token class-name">EditorWindow</span> window<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// targetsにはヒエラルキーで選択している全Playerクラスのインスタンス</span>
    <span class="token comment">// がObjectとしてダウンキャストされて格納されている</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> obj <span class="token keyword">in</span> targets<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Objectなので、対象の型（この場合はPlayer）にアップキャストして利用する</span>
        <span class="token class-name"><span class="token keyword">var</span></span> player <span class="token operator">=</span> obj <span class="token keyword">as</span> <span class="token class-name">Player</span><span class="token punctuation">;</span>

        <span class="token comment">// playerクラスのインスタンスが取れたので、あとはプロパティ編集GUIを描画する</span>
    <span class="token punctuation">}</span></code></pre></div>
<h3 id="シーンビュー上でguiを描画する方法" style="position:relative;"><a href="#%E3%82%B7%E3%83%BC%E3%83%B3%E3%83%93%E3%83%A5%E3%83%BC%E4%B8%8A%E3%81%A7gui%E3%82%92%E6%8F%8F%E7%94%BB%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95" aria-label="シーンビュー上でguiを描画する方法 permalink" class="header-link before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>シーンビュー上でGUIを描画する方法</h3>
<p>今回のツールのおもしろい点として、プロパティ編集のGUIを、その<strong>オブジェクトの位置に合わせて</strong>描画しています。
つまり、<strong>オブジェクトのワールド座標をシーンビューのスクリーン座標に変換</strong>して、<strong>シーンビュー上にGUIを描画</strong>する必要があります。</p>
<p>まず、ワールド座標からシーンビューのスクリーン座標の変換を行うには、<a href="https://docs.unity3d.com/ScriptReference/HandleUtility.WorldToGUIPoint.html">HandleUtility.WorldToGUIPoint</a>を利用します。</p>
<div class="gatsby-highlight" data-language="cs"><pre class="language-cs"><code class="language-cs"><span class="token class-name"><span class="token keyword">var</span></span> guiPoint <span class="token operator">=</span> HandleUtility<span class="token punctuation">.</span><span class="token function">WorldToGUIPoint</span><span class="token punctuation">(</span>player<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>次にシーンビュー上にGUIを描画します。<code>OnToolGUI</code>でGUIを描画するには、<a href="https://docs.unity3d.com/ScriptReference/Handles.BeginGUI.html">Handles.BeginGUI()</a>を呼び出して、GUIを描画することを宣言する必要があります。
GUIの描画を終了する場合は、<a href="https://docs.unity3d.com/ScriptReference/Handles.EndGUI.html">Handles.EndGUI()</a>を呼び出します。これを呼び出さないと<code>Handles.PositionHandle</code>などの3Dハンドルの描画が行えなくなります。</p>
<div class="gatsby-highlight" data-language="cs"><pre class="language-cs"><code class="language-cs">Handles<span class="token punctuation">.</span><span class="token function">BeginGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// --- ここからGUI描画ができる ---</span>

<span class="token comment">// ただし3Dハンドルの描画は行えない</span>

<span class="token comment">// --- ここまでGUI描画ができる ---</span>
Handles<span class="token punctuation">.</span><span class="token function">EndGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// --- ここから3Dハンドルの描画がおこなえる</span></code></pre></div>
<p>あとは、プロパティ編集GUIを描画します。今回は<code>SerializedObject</code>および<code>EditorGUI.PropertyField</code>用いて実装します。GUIの位置は、さきほど計算した<code>guiPoint</code>を利用しています。</p>
<div class="gatsby-highlight" data-language="cs"><pre class="language-cs"><code class="language-cs"><span class="token class-name"><span class="token keyword">var</span></span> nameProperty <span class="token operator">=</span> serializedObject<span class="token punctuation">.</span><span class="token function">FindProperty</span><span class="token punctuation">(</span><span class="token string">"_name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
EditorGUI<span class="token punctuation">.</span><span class="token function">PropertyField</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rect</span><span class="token punctuation">(</span>guiPoint <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nameProperty<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> powerProperty <span class="token operator">=</span> serializedObject<span class="token punctuation">.</span><span class="token function">FindProperty</span><span class="token punctuation">(</span><span class="token string">"_power"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
EditorGUI<span class="token punctuation">.</span><span class="token function">PropertyField</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rect</span><span class="token punctuation">(</span>guiPoint <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> powerProperty<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> playerTypeProperty <span class="token operator">=</span> serializedObject<span class="token punctuation">.</span><span class="token function">FindProperty</span><span class="token punctuation">(</span><span class="token string">"_playerType"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
EditorGUI<span class="token punctuation">.</span><span class="token function">PropertyField</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rect</span><span class="token punctuation">(</span>guiPoint <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> playerTypeProperty<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// プロパティの変更を適用する</span>
serializedObject<span class="token punctuation">.</span><span class="token function">ApplyModifiedProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>実装は以上です。プロパティ編集のために<code>SerializedObject</code>を利用するのはよく知られていると思いますが、ワールド座標からシーンビューのスクリーン座標の変換や、GUIと3Dハンドルの描画の共存は意外にあまり知られてないのではと思います。</p>
<h2 id="まとめ" style="position:relative;"><a href="#%E3%81%BE%E3%81%A8%E3%82%81" aria-label="まとめ permalink" class="header-link before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>まとめ</h2>
<p>2019.1から導入されたEditor Toolsについて、ツールの基本的な実装方法や、応用例としてシーンビュー上にGUIを描画してプロパティを編集するツールの実装方法を紹介しました。
アイデア次第では、ゲーム開発を便利にするさまざまなツールを作ることができそうで、とてもおもしろいAPIだと感じました。</p></div></article></div></main><footer class="container max-w-3xl mx-auto pt-10 pb-10"><div class="flex justify-center gap-6"><a class="hover:no-underline text-gray-800" href="/">Home</a><a class="hover:no-underline text-gray-800" href="/profile">Profile</a><a class="hover:no-underline text-gray-800" href="/project/unity-weekly">Unity Weekly</a></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2020/09/editor-tools/";window.___webpackCompilationHash="094f59a18b4ca7e18945";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-4bae0ebd19da6d624f9b.js"],"app":["/app-af3c6be3755c0810b80f.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-42660d3ea51266f3e6ca.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-25c83ed41e02527f6e75.js"],"component---src-pages-project-unity-weekly-tsx":["/component---src-pages-project-unity-weekly-tsx-85146e2f653cf86267ba.js"],"component---src-pages-tags-tsx":["/component---src-pages-tags-tsx-7d944f901b66b6d75221.js"],"component---src-templates-post-tsx":["/component---src-templates-post-tsx-5cf0013df3037b91cf03.js"],"component---src-templates-tag-tsx":["/component---src-templates-tag-tsx-5a26138ea8576f0bb25c.js"]};/*]]>*/</script><script src="/polyfill-4bae0ebd19da6d624f9b.js" nomodule=""></script><script src="/app-af3c6be3755c0810b80f.js" async=""></script><script src="/framework-6ad8a8eb04f78e566be1.js" async=""></script><script src="/webpack-runtime-e2204fc0d98161dad324.js" async=""></script></body></html>